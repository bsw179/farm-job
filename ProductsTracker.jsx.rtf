{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red89\green138\blue67;\red24\green24\blue24;\red193\green193\blue193;
\red183\green111\blue179;\red140\green211\blue254;\red194\green126\blue101;\red70\green137\blue204;\red212\green214\blue154;
\red66\green179\blue255;\red202\green202\blue202;\red67\green192\blue160;\red167\green197\blue152;\red109\green109\blue109;
\red205\green173\blue106;}
{\*\expandedcolortbl;;\cssrgb\c41569\c60000\c33333;\cssrgb\c12157\c12157\c12157;\cssrgb\c80000\c80000\c80000;
\cssrgb\c77255\c52549\c75294;\cssrgb\c61176\c86275\c99608;\cssrgb\c80784\c56863\c47059;\cssrgb\c33725\c61176\c83922;\cssrgb\c86275\c86275\c66667;
\cssrgb\c30980\c75686\c100000;\cssrgb\c83137\c83137\c83137;\cssrgb\c30588\c78824\c69020;\cssrgb\c70980\c80784\c65882;\cssrgb\c50196\c50196\c50196;
\cssrgb\c84314\c72941\c49020;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 // ProductsTracker.jsx\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 React\cf4 \strokec4 , \{ \cf6 \strokec6 useEffect\cf4 \strokec4 , \cf6 \strokec6 useState\cf4 \strokec4  \} \cf5 \strokec5 from\cf4 \strokec4  \cf7 \strokec7 'react'\cf4 \strokec4 ;\cb1 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \{ \cf6 \strokec6 useNavigate\cf4 \strokec4  \} \cf5 \strokec5 from\cf4 \strokec4  \cf7 \strokec7 'react-router-dom'\cf4 \strokec4 ;\cb1 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \{ \cf6 \strokec6 db\cf4 \strokec4  \} \cf5 \strokec5 from\cf4 \strokec4  \cf7 \strokec7 '../firebase'\cf4 \strokec4 ;\cb1 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \{ \cf6 \strokec6 collection\cf4 \strokec4 , \cf6 \strokec6 getDocs\cf4 \strokec4  \} \cf5 \strokec5 from\cf4 \strokec4  \cf7 \strokec7 'firebase/firestore'\cf4 \strokec4 ;\cb1 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \{ \cf6 \strokec6 useCropYear\cf4 \strokec4  \} \cf5 \strokec5 from\cf4 \strokec4  \cf7 \strokec7 '../context/CropYearContext'\cf4 \strokec4 ;\cb1 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \{ \cf6 \strokec6 Link\cf4 \strokec4  \} \cf5 \strokec5 from\cf4 \strokec4  \cf7 \strokec7 'react-router-dom'\cf4 \strokec4 ;\cb1 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 LogInputsPurchase\cf4 \strokec4  \cf5 \strokec5 from\cf4 \strokec4  \cf7 \strokec7 '../components/LogInputsPurchase'\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 function\cf4 \strokec4  \cf9 \strokec9 getLastPurchaseDate\cf4 \strokec4 (\cf6 \strokec6 productId\cf4 \strokec4 , \cf6 \strokec6 purchases\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 matching\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf6 \strokec6 purchases\cf4 \cb1 \strokec4 \
\cb3     .\cf9 \strokec9 filter\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf6 \strokec6 productId\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 date\cf4 \strokec4 )\cb1 \
\cb3     .\cf9 \strokec9 map\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Date\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 date\cf4 \strokec4 ));\cb1 \
\
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 matching\cf4 \strokec4 .\cf6 \strokec6 length\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 null\cf4 \strokec4 ;\cb1 \
\
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 latest\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Date\cf4 \strokec4 (\cf6 \strokec6 Math\cf4 \strokec4 .\cf9 \strokec9 max\cf4 \strokec4 (\cf11 \strokec11 ...\cf10 \strokec10 matching\cf4 \strokec4 ));\cb1 \
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf10 \strokec10 latest\cf4 \strokec4 .\cf9 \strokec9 toLocaleDateString\cf4 \strokec4 (); \cf2 \strokec2 // or use your preferred format\cf4 \cb1 \strokec4 \
\cb3 \}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 function\cf4 \strokec4  \cf9 \strokec9 getProductPurchaseStats\cf4 \strokec4 (\cf6 \strokec6 productId\cf4 \strokec4 , \cf6 \strokec6 purchases\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 let\cf4 \strokec4  \cf6 \strokec6 totalNormalized\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ;\cb1 \
\cb3   \cf8 \strokec8 let\cf4 \strokec4  \cf6 \strokec6 totalCost\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ;\cb1 \
\cb3   \cf8 \strokec8 let\cf4 \strokec4  \cf6 \strokec6 totalAmount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ; \cf2 \strokec2 // this is amount of purchased units\cf4 \cb1 \strokec4 \
\
\cb3   \cf5 \strokec5 for\cf4 \strokec4  (\cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 p\cf4 \strokec4  \cf8 \strokec8 of\cf4 \strokec4  \cf6 \strokec6 purchases\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4  \cf11 \strokec11 !==\cf4 \strokec4  \cf6 \strokec6 productId\cf4 \strokec4 ) \cf5 \strokec5 continue\cf4 \strokec4 ;\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 amount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 amount\cf4 \strokec4 );\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 unitSize\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 unitSize\cf4 \strokec4 );\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 cost\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 cost\cf4 \strokec4 );\cb1 \
\
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf9 \strokec9 isNaN\cf4 \strokec4 (\cf10 \strokec10 amount\cf4 \strokec4 ) \cf11 \strokec11 &&\cf4 \strokec4  \cf11 \strokec11 !\cf9 \strokec9 isNaN\cf4 \strokec4 (\cf10 \strokec10 unitSize\cf4 \strokec4 )) \{\cb1 \
\cb3       \cf6 \strokec6 totalNormalized\cf4 \strokec4  \cf11 \strokec11 +=\cf4 \strokec4  \cf10 \strokec10 amount\cf4 \strokec4  \cf11 \strokec11 *\cf4 \strokec4  \cf10 \strokec10 unitSize\cf4 \strokec4 ;\cb1 \
\cb3       \cf6 \strokec6 totalAmount\cf4 \strokec4  \cf11 \strokec11 +=\cf4 \strokec4  \cf10 \strokec10 amount\cf4 \strokec4 ;\cb1 \
\
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf9 \strokec9 isNaN\cf4 \strokec4 (\cf10 \strokec10 cost\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf6 \strokec6 totalCost\cf4 \strokec4  \cf11 \strokec11 +=\cf4 \strokec4  \cf10 \strokec10 cost\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf6 \strokec6 totalPurchased:\cf4 \strokec4  \cf6 \strokec6 totalNormalized\cf4 \strokec4 ,              \cf2 \strokec2 // normalized amount (e.g. lbs, seeds)\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 totalCost\cf4 \strokec4 ,                                    \cf2 \strokec2 // total invoice cost\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 avgNormalizedUnitPrice:\cf4 \strokec4  \cf6 \strokec6 totalNormalized\cf4 \strokec4  \cf11 \strokec11 >\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4  \cf11 \strokec11 ?\cf4 \strokec4  \cf6 \strokec6 totalCost\cf4 \strokec4  \cf11 \strokec11 /\cf4 \strokec4  \cf6 \strokec6 totalNormalized\cf4 \strokec4  \cf11 \strokec11 :\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ,\cb1 \
\cb3     \cf6 \strokec6 avgPurchaseUnitPrice:\cf4 \strokec4  \cf6 \strokec6 totalAmount\cf4 \strokec4  \cf11 \strokec11 >\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4  \cf11 \strokec11 ?\cf4 \strokec4  \cf6 \strokec6 totalCost\cf4 \strokec4  \cf11 \strokec11 /\cf4 \strokec4  \cf6 \strokec6 totalAmount\cf4 \strokec4  \cf11 \strokec11 :\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ,\cb1 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 function\cf4 \strokec4  \cf9 \strokec9 ProductsTracker\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 const\cf4 \strokec4  \{ \cf10 \strokec10 cropYear\cf4 \strokec4  \} \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useCropYear\cf4 \strokec4 ();\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf9 \strokec9 navigate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useNavigate\cf4 \strokec4 ();\cb1 \
\
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 products\cf4 \strokec4 , \cf9 \strokec9 setProducts\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 ([]);\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 jobsByField\cf4 \strokec4 , \cf9 \strokec9 setJobsByField\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 ([]);\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 purchases\cf4 \strokec4 , \cf9 \strokec9 setPurchases\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 ([]);\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 appliedTotals\cf4 \strokec4 , \cf9 \strokec9 setAppliedTotals\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\{\});\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 appliedByOperator\cf4 \strokec4 , \cf9 \strokec9 setAppliedByOperator\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\{\});\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 selectedProductIds\cf4 \strokec4 , \cf9 \strokec9 setSelectedProductIds\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 ([]);\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 filterText\cf4 \strokec4 , \cf9 \strokec9 setFilterText\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\cf7 \strokec7 ''\cf4 \strokec4 );\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 sortOption\cf4 \strokec4 , \cf9 \strokec9 setSortOption\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\cf7 \strokec7 'name'\cf4 \strokec4 );\cb1 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 isFilterOpen\cf4 \strokec4 , \cf9 \strokec9 setIsFilterOpen\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\cf8 \strokec8 false\cf4 \strokec4 );\cb1 \
\
\cf8 \cb3 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 filters\cf4 \strokec4 , \cf9 \strokec9 setFilters\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 types:\cf4 \strokec4  [], \cf2 \strokec2 // e.g., ['Chemical', 'Seed']\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 crops:\cf4 \strokec4  [], \cf2 \strokec2 // e.g., ['Rice']\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 vendor:\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ,\cb1 \
\cb3   \cf6 \strokec6 startDate:\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ,\cb1 \
\cb3   \cf6 \strokec6 endDate:\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ,\cb1 \
\cb3   \cf6 \strokec6 restrictedOnly:\cf4 \strokec4  \cf8 \strokec8 false\cf4 \strokec4 ,\cb1 \
\cb3 \});\cb1 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 purchaseModalOpen\cf4 \strokec4 , \cf9 \strokec9 setPurchaseModalOpen\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\cf8 \strokec8 false\cf4 \strokec4 );\cb1 \
\cf8 \cb3 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 modalProducts\cf4 \strokec4 , \cf9 \strokec9 setModalProducts\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 ([]);\cb1 \
\cf8 \cb3 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 editPurchase\cf4 \strokec4 , \cf9 \strokec9 setEditPurchase\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 useState\cf4 \strokec4 (\cf8 \strokec8 null\cf4 \strokec4 );\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf2 \strokec2 // Load everything\cf4 \cb1 \strokec4 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf9 \strokec9 loadData\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf8 \strokec8 async\cf4 \strokec4  () \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  [\cf10 \strokec10 productSnap\cf4 \strokec4 , \cf10 \strokec10 jobSnap\cf4 \strokec4 , \cf10 \strokec10 purchaseSnap\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf5 \strokec5 await\cf4 \strokec4  \cf12 \strokec12 Promise\cf4 \strokec4 .\cf9 \strokec9 all\cf4 \strokec4 ([\cb1 \
\cb3     \cf9 \strokec9 getDocs\cf4 \strokec4 (\cf9 \strokec9 collection\cf4 \strokec4 (\cf10 \strokec10 db\cf4 \strokec4 , \cf7 \strokec7 'products'\cf4 \strokec4 )),\cb1 \
\cb3     \cf9 \strokec9 getDocs\cf4 \strokec4 (\cf9 \strokec9 collection\cf4 \strokec4 (\cf10 \strokec10 db\cf4 \strokec4 , \cf7 \strokec7 'jobsByField'\cf4 \strokec4 )),\cb1 \
\cb3     \cf9 \strokec9 getDocs\cf4 \strokec4 (\cf9 \strokec9 collection\cf4 \strokec4 (\cf10 \strokec10 db\cf4 \strokec4 , \cf7 \strokec7 'inputPurchases'\cf4 \strokec4 )),\cb1 \
\cb3   ]);\cb1 \
\
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 allProducts\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 productSnap\cf4 \strokec4 .\cf6 \strokec6 docs\cf4 \strokec4 .\cf9 \strokec9 map\cf4 \strokec4 (\cf6 \strokec6 doc\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  (\{ \cf6 \strokec6 id:\cf4 \strokec4  \cf6 \strokec6 doc\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 , \cf11 \strokec11 ...\cf6 \strokec6 doc\cf4 \strokec4 .\cf9 \strokec9 data\cf4 \strokec4 () \}));\cb1 \
\
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 filteredJobs\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 jobSnap\cf4 \strokec4 .\cf6 \strokec6 docs\cf4 \cb1 \strokec4 \
\cb3     .\cf9 \strokec9 map\cf4 \strokec4 (\cf6 \strokec6 doc\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  (\{ \cf6 \strokec6 id:\cf4 \strokec4  \cf6 \strokec6 doc\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 , \cf11 \strokec11 ...\cf6 \strokec6 doc\cf4 \strokec4 .\cf9 \strokec9 data\cf4 \strokec4 () \}))\cb1 \
\cb3     .\cf9 \strokec9 filter\cf4 \strokec4 (\cf6 \strokec6 job\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 cropYear\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf10 \strokec10 cropYear\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 status\cf4 \strokec4  \cf11 \strokec11 !==\cf4 \strokec4  \cf7 \strokec7 'Planned'\cf4 \strokec4 );\cb1 \
\
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 filteredPurchases\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 purchaseSnap\cf4 \strokec4 .\cf6 \strokec6 docs\cf4 \cb1 \strokec4 \
\cb3     .\cf9 \strokec9 map\cf4 \strokec4 (\cf6 \strokec6 doc\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  (\{ \cf6 \strokec6 id:\cf4 \strokec4  \cf6 \strokec6 doc\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 , \cf11 \strokec11 ...\cf6 \strokec6 doc\cf4 \strokec4 .\cf9 \strokec9 data\cf4 \strokec4 () \}))\cb1 \
\cb3     .\cf9 \strokec9 filter\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf12 \strokec12 String\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 cropYear\cf4 \strokec4 ) \cf11 \strokec11 ===\cf4 \strokec4  \cf12 \strokec12 String\cf4 \strokec4 (\cf10 \strokec10 cropYear\cf4 \strokec4 ));\cb1 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 console\cf4 \strokec4 .\cf9 \strokec9 log\cf4 \strokec4 (\cf7 \strokec7 '\uc0\u55357 \u56550  Purchases loaded:'\cf4 \strokec4 , \cf10 \strokec10 filteredPurchases\cf4 \strokec4 );\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 usedProductIds\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Set\cf4 \strokec4 ();\cb1 \
\cb3   \cf10 \strokec10 filteredJobs\cf4 \strokec4 .\cf9 \strokec9 forEach\cf4 \strokec4 (\cf6 \strokec6 job\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\cb3     (\cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 products\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  []).\cf9 \strokec9 forEach\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ) \cf10 \strokec10 usedProductIds\cf4 \strokec4 .\cf9 \strokec9 add\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 );\cb1 \
\cb3     \});\cb1 \
\cb3   \});\cb1 \
\
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 purchasedProductIds\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Set\cf4 \strokec4 (\cf10 \strokec10 filteredPurchases\cf4 \strokec4 .\cf9 \strokec9 map\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ));\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 filteredProducts\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 allProducts\cf4 \strokec4 .\cf9 \strokec9 filter\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \cb1 \strokec4 \
\cb3     \cf10 \strokec10 usedProductIds\cf4 \strokec4 .\cf9 \strokec9 has\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 ) \cf11 \strokec11 ||\cf4 \strokec4  \cf10 \strokec10 purchasedProductIds\cf4 \strokec4 .\cf9 \strokec9 has\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 )\cb1 \
\cb3   );\cb1 \
\
\cb3   \cf9 \strokec9 setProducts\cf4 \strokec4 (\cf10 \strokec10 filteredProducts\cf4 \strokec4 );\cb1 \
\cb3   \cf9 \strokec9 setJobsByField\cf4 \strokec4 (\cf10 \strokec10 filteredJobs\cf4 \strokec4 );\cb1 \
\cb3   \cf9 \strokec9 setPurchases\cf4 \strokec4 (\cf10 \strokec10 filteredPurchases\cf4 \strokec4 );\cb1 \
\cb3 \};\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9 useEffect\cf4 \strokec4 (() \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf9 \strokec9 loadData\cf4 \strokec4 ();\cb1 \
\cb3 \}, [\cf10 \strokec10 cropYear\cf4 \strokec4 ]);\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9 useEffect\cf4 \strokec4 (() \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 totals\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \{\};\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 operatorApplied\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \{\}; \cf2 \strokec2 // \{ productId: \{ PCF: x, TCF: y \} \}\cf4 \cb1 \strokec4 \
\
\cb3   \cf5 \strokec5 for\cf4 \strokec4  (\cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 job\cf4 \strokec4  \cf8 \strokec8 of\cf4 \strokec4  \cf6 \strokec6 jobsByField\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 jobProducts\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 products\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  [];\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 operator\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 operator\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf7 \strokec7 'Unknown'\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf5 \strokec5 for\cf4 \strokec4  (\cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 p\cf4 \strokec4  \cf8 \strokec8 of\cf4 \strokec4  \cf6 \strokec6 jobProducts\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 id\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ;\cb1 \
\cb3       \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 rawUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 unit\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ).\cf9 \strokec9 toLowerCase\cf4 \strokec4 ();\cb1 \
\cb3       \cf8 \strokec8 let\cf4 \strokec4  \cf6 \strokec6 appliedAmount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ;\cb1 \
\cb3       \cf8 \strokec8 let\cf4 \strokec4  \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ;\cb1 \
\
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 rawUnit\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 '%v/v'\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 job\cf4 \strokec4 .\cf6 \strokec6 waterVolume\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 rate\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 );\cb1 \
\cb3         \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 water\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 job\cf4 \strokec4 .\cf6 \strokec6 waterVolume\cf4 \strokec4 );\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf9 \strokec9 isNaN\cf4 \strokec4 (\cf10 \strokec10 rate\cf4 \strokec4 ) \cf11 \strokec11 &&\cf4 \strokec4  \cf11 \strokec11 !\cf9 \strokec9 isNaN\cf4 \strokec4 (\cf10 \strokec10 water\cf4 \strokec4 )) \{\cb1 \
\cb3           \cf6 \strokec6 appliedAmount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 *\cf4 \strokec4  \cf10 \strokec10 water\cf4 \strokec4  \cf11 \strokec11 *\cf4 \strokec4  \cf13 \strokec13 128\cf4 \strokec4 ;\cb1 \
\cb3           \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf7 \strokec7 'fl oz'\cf4 \strokec4 ;\cb1 \
\cb3         \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3           \cf5 \strokec5 continue\cf4 \strokec4 ;\cb1 \
\cb3         \}\cb1 \
\cb3       \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 rate\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 );\cb1 \
\cb3         \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 acres\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 job\cf4 \strokec4 .\cf6 \strokec6 acres\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 );\cb1 \
\cb3         \cf6 \strokec6 appliedAmount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 *\cf4 \strokec4  \cf10 \strokec10 acres\cf4 \strokec4 ;\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 rawUnit\cf4 \strokec4 .\cf9 \strokec9 includes\cf4 \strokec4 (\cf7 \strokec7 '/'\cf4 \strokec4 )) \{\cb1 \
\cb3           \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rawUnit\cf4 \strokec4 .\cf9 \strokec9 split\cf4 \strokec4 (\cf7 \strokec7 '/'\cf4 \strokec4 )[\cf13 \strokec13 0\cf4 \strokec4 ].\cf9 \strokec9 trim\cf4 \strokec4 ();\cb1 \
\cb3         \} \cf5 \strokec5 else\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 rawUnit\cf4 \strokec4 .\cf9 \strokec9 includes\cf4 \strokec4 (\cf7 \strokec7 '%'\cf4 \strokec4 )) \{\cb1 \
\cb3           \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rawUnit\cf4 \strokec4 .\cf9 \strokec9 replace\cf4 \strokec4 (\cf7 \strokec7 '%'\cf4 \strokec4 , \cf7 \strokec7 ''\cf4 \strokec4 ).\cf9 \strokec9 trim\cf4 \strokec4 ();\cb1 \
\cb3         \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3           \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rawUnit\cf4 \strokec4 ;\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf10 \strokec10 totals\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ]) \{\cb1 \
\cb3         \cf10 \strokec10 totals\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \{ \cf6 \strokec6 amount:\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 , \cf6 \strokec6 unit:\cf4 \strokec4  \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \};\cb1 \
\cb3       \}\cb1 \
\cb3       \cf10 \strokec10 totals\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ].\cf6 \strokec6 amount\cf4 \strokec4  \cf11 \strokec11 +=\cf4 \strokec4  \cf6 \strokec6 appliedAmount\cf4 \strokec4 ;\cb1 \
\
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf10 \strokec10 operatorApplied\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ]) \{\cb1 \
\cb3         \cf10 \strokec10 operatorApplied\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \{ \cf6 \strokec6 PCF:\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 , \cf6 \strokec6 TCF:\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4  \};\cb1 \
\cb3       \}\cb1 \
\
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 operator\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 'PCF'\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf10 \strokec10 operator\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 'TCF'\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf10 \strokec10 operatorApplied\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ][\cf10 \strokec10 operator\cf4 \strokec4 ] \cf11 \strokec11 +=\cf4 \strokec4  \cf6 \strokec6 appliedAmount\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf9 \strokec9 setAppliedTotals\cf4 \strokec4 (\cf10 \strokec10 totals\cf4 \strokec4 );\cb1 \
\cb3   \cf9 \strokec9 setAppliedByOperator\cf4 \strokec4 (\cf10 \strokec10 operatorApplied\cf4 \strokec4 );\cb1 \
\cb3 \}, [\cf10 \strokec10 jobsByField\cf4 \strokec4 ]);\cb1 \
\
\cb3   \cf2 \strokec2 // Compute applied totals\cf4 \cb1 \strokec4 \
\cb3  \cf9 \strokec9 useEffect\cf4 \strokec4 (() \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 totals\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \{\};\cb1 \
\
\cb3   \cf5 \strokec5 for\cf4 \strokec4  (\cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 job\cf4 \strokec4  \cf8 \strokec8 of\cf4 \strokec4  \cf10 \strokec10 jobsByField\cf4 \strokec4 ) \{\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 jobProducts\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 job\cf4 \strokec4 .\cf6 \strokec6 products\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  [];\cb1 \
\
\cb3   \cf5 \strokec5 for\cf4 \strokec4  (\cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 p\cf4 \strokec4  \cf8 \strokec8 of\cf4 \strokec4  \cf10 \strokec10 jobProducts\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 id\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ;\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 rawUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 unit\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ).\cf9 \strokec9 toLowerCase\cf4 \strokec4 ();\cb1 \
\cb3     \cf8 \strokec8 let\cf4 \strokec4  \cf6 \strokec6 appliedAmount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ;\cb1 \
\cb3     \cf8 \strokec8 let\cf4 \strokec4  \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 rawUnit\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 '%v/v'\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 job\cf4 \strokec4 .\cf6 \strokec6 waterVolume\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 rate\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 );\cb1 \
\cb3       \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 water\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 job\cf4 \strokec4 .\cf6 \strokec6 waterVolume\cf4 \strokec4 );\cb1 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf9 \strokec9 isNaN\cf4 \strokec4 (\cf10 \strokec10 rate\cf4 \strokec4 ) \cf11 \strokec11 &&\cf4 \strokec4  \cf11 \strokec11 !\cf9 \strokec9 isNaN\cf4 \strokec4 (\cf10 \strokec10 water\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf6 \strokec6 appliedAmount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 *\cf4 \strokec4  \cf10 \strokec10 water\cf4 \strokec4  \cf11 \strokec11 *\cf4 \strokec4  \cf13 \strokec13 128\cf4 \strokec4 ; \cf2 \strokec2 // convert to fl oz\cf4 \cb1 \strokec4 \
\cb3         \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf7 \strokec7 'fl oz'\cf4 \strokec4 ;\cb1 \
\cb3       \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf5 \strokec5 continue\cf4 \strokec4 ; \cf2 \strokec2 // skip if data is invalid\cf4 \cb1 \strokec4 \
\cb3       \}\cb1 \
\cb3     \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 p\cf4 \strokec4 .\cf6 \strokec6 rate\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 );\cb1 \
\cb3       \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 acres\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 parseFloat\cf4 \strokec4 (\cf10 \strokec10 job\cf4 \strokec4 .\cf6 \strokec6 acres\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 appliedAmount\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rate\cf4 \strokec4  \cf11 \strokec11 *\cf4 \strokec4  \cf10 \strokec10 acres\cf4 \strokec4 ;\cb1 \
\
\cb3       \cf2 \strokec2 // Normalize unit (e.g. fl oz/acre \uc0\u8594  fl oz)\cf4 \cb1 \strokec4 \
\cb3       \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 rawUnit\cf4 \strokec4 .\cf9 \strokec9 includes\cf4 \strokec4 (\cf7 \strokec7 '/'\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rawUnit\cf4 \strokec4 .\cf9 \strokec9 split\cf4 \strokec4 (\cf7 \strokec7 '/'\cf4 \strokec4 )[\cf13 \strokec13 0\cf4 \strokec4 ].\cf9 \strokec9 trim\cf4 \strokec4 ();\cb1 \
\cb3       \} \cf5 \strokec5 else\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 rawUnit\cf4 \strokec4 .\cf9 \strokec9 includes\cf4 \strokec4 (\cf7 \strokec7 '%'\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf6 \strokec6 rawUnit\cf4 \strokec4 .\cf9 \strokec9 replace\cf4 \strokec4 (\cf7 \strokec7 '%'\cf4 \strokec4 , \cf7 \strokec7 ''\cf4 \strokec4 ).\cf9 \strokec9 trim\cf4 \strokec4 ();\cb1 \
\cb3       \} \cf5 \strokec5 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 rawUnit\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf10 \strokec10 totals\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ]) \{\cb1 \
\cb3       \cf10 \strokec10 totals\cf4 \strokec4 [\cf10 \strokec10 id\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \{ \cf6 \strokec6 amount:\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 , \cf6 \strokec6 unit:\cf4 \strokec4  \cf6 \strokec6 normalizedUnit\cf4 \strokec4  \};\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf10 \strokec10 totals\cf4 \strokec4 [\cf6 \strokec6 id\cf4 \strokec4 ].\cf6 \strokec6 amount\cf4 \strokec4  \cf11 \strokec11 +=\cf4 \strokec4  \cf6 \strokec6 appliedAmount\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\
\cb3   \cf9 \strokec9 setAppliedTotals\cf4 \strokec4 (\cf10 \strokec10 totals\cf4 \strokec4 );\cb1 \
\cb3 \}, [\cf10 \strokec10 jobsByField\cf4 \strokec4 ]);\cb1 \
\
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Count all products used or purchased in this crop year\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 allUsedOrPurchasedIds\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Set\cf4 \strokec4 ();\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \cb3 \strokec10 jobsByField\cf4 \strokec4 .\cf9 \strokec9 forEach\cf4 \strokec4 (\cf6 \strokec6 job\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   (\cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 products\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  []).\cf9 \strokec9 forEach\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ) \cf10 \strokec10 allUsedOrPurchasedIds\cf4 \strokec4 .\cf9 \strokec9 add\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 );\cb1 \
\cb3   \});\cb1 \
\cb3 \});\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \cb3 \strokec10 purchases\cf4 \strokec4 .\cf9 \strokec9 forEach\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ) \cf10 \strokec10 allUsedOrPurchasedIds\cf4 \strokec4 .\cf9 \strokec9 add\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 );\cb1 \
\cb3 \});\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 productIdToCrops\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \{\};\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \cb3 \strokec10 jobsByField\cf4 \strokec4 .\cf9 \strokec9 forEach\cf4 \strokec4 (\cf6 \strokec6 job\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 jobCrop\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 crop\cf4 \strokec4 ;\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 jobProducts\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf6 \strokec6 job\cf4 \strokec4 .\cf6 \strokec6 products\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  [];\cb1 \
\
\cb3   \cf10 \strokec10 jobProducts\cf4 \strokec4 .\cf9 \strokec9 forEach\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf11 \strokec11 !\cf10 \strokec10 jobCrop\cf4 \strokec4 ) \cf5 \strokec5 return\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf11 \strokec11 !\cf10 \strokec10 productIdToCrops\cf4 \strokec4 [\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ]) \{\cb1 \
\cb3       \cf10 \strokec10 productIdToCrops\cf4 \strokec4 [\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ] \cf11 \strokec11 =\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Set\cf4 \strokec4 ();\cb1 \
\cb3     \}\cb1 \
\cb3     \cf10 \strokec10 productIdToCrops\cf4 \strokec4 [\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4 ].\cf9 \strokec9 add\cf4 \strokec4 (\cf10 \strokec10 jobCrop\cf4 \strokec4 );\cb1 \
\cb3   \});\cb1 \
\cb3 \});\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 filteredProducts\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 products\cf4 \strokec4 .\cf9 \strokec9 filter\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 matchesText\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 name\cf4 \strokec4 .\cf9 \strokec9 toLowerCase\cf4 \strokec4 ().\cf9 \strokec9 includes\cf4 \strokec4 (\cf10 \strokec10 filterText\cf4 \strokec4 .\cf9 \strokec9 toLowerCase\cf4 \strokec4 ());\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 matchesType\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 types\cf4 \strokec4 .\cf6 \strokec6 length\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 types\cf4 \strokec4 .\cf9 \strokec9 includes\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 type\cf4 \strokec4 );\cb1 \
\
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 productCrops\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 productIdToCrops\cf4 \strokec4 [\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 ] \cf11 \strokec11 ||\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Set\cf4 \strokec4 ();\cb1 \
\cb3   \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 matchesCrop\cf4 \strokec4  \cf11 \strokec11 =\cf4 \cb1 \strokec4 \
\cb3     \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 crops\cf4 \strokec4 .\cf6 \strokec6 length\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \cb1 \strokec4 \
\cb3     [\cf11 \strokec11 ...\cf10 \strokec10 productCrops\cf4 \strokec4 ].\cf9 \strokec9 some\cf4 \strokec4 (\cf6 \strokec6 crop\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 crops\cf4 \strokec4 .\cf9 \strokec9 includes\cf4 \strokec4 (\cf6 \strokec6 crop\cf4 \strokec4 ));\cb1 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 matchesVendor\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 vendor\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf10 \strokec10 purchases\cf4 \strokec4 .\cf9 \strokec9 some\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 vendor\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 vendor\cf4 \strokec4 );\cb1 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 matchesDate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf11 \strokec11 !\cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 startDate\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf11 \strokec11 !\cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 endDate\cf4 \cb1 \strokec4 \
\cb3     \cf11 \strokec11 ?\cf4 \strokec4  \cf8 \strokec8 true\cf4 \cb1 \strokec4 \
\cb3     \cf11 \strokec11 :\cf4 \strokec4  \cf10 \strokec10 purchases\cf4 \strokec4 .\cf9 \strokec9 some\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 productId\cf4 \strokec4  \cf11 \strokec11 !==\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf11 \strokec11 !\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 date\cf4 \strokec4 ) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 false\cf4 \strokec4 ;\cb1 \
\cb3         \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 date\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Date\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 date\cf4 \strokec4 );\cb1 \
\cb3         \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 start\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 startDate\cf4 \strokec4  \cf11 \strokec11 ?\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Date\cf4 \strokec4 (\cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 startDate\cf4 \strokec4 ) \cf11 \strokec11 :\cf4 \strokec4  \cf8 \strokec8 null\cf4 \strokec4 ;\cb1 \
\cb3         \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 end\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 endDate\cf4 \strokec4  \cf11 \strokec11 ?\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Date\cf4 \strokec4 (\cf10 \strokec10 filters\cf4 \strokec4 .\cf6 \strokec6 endDate\cf4 \strokec4 ) \cf11 \strokec11 :\cf4 \strokec4  \cf8 \strokec8 null\cf4 \strokec4 ;\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 start\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 date\cf4 \strokec4  \cf11 \strokec11 <\cf4 \strokec4  \cf10 \strokec10 start\cf4 \strokec4 ) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 false\cf4 \strokec4 ;\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 end\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 date\cf4 \strokec4  \cf11 \strokec11 >\cf4 \strokec4  \cf10 \strokec10 end\cf4 \strokec4 ) \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 false\cf4 \strokec4 ;\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 true\cf4 \strokec4 ;\cb1 \
\cb3       \});\cb1 \
\
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 return\cf4 \strokec4  \cf10 \strokec10 matchesText\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 matchesType\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 matchesCrop\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 matchesVendor\cf4 \strokec4  \cf11 \strokec11 &&\cf4 \strokec4  \cf10 \strokec10 matchesDate\cf4 \strokec4 ;\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \});\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 console\cf4 \strokec4 .\cf9 \strokec9 log\cf4 \strokec4 (\cf7 \strokec7 '\uc0\u9989  Products after filtering:'\cf4 \strokec4 , \cf10 \strokec10 filteredProducts\cf4 \strokec4 .\cf9 \strokec9 map\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 name\cf4 \strokec4 ));\cb1 \
\
\
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 sortedProducts\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  [\cf11 \strokec11 ...\cf10 \strokec10 filteredProducts\cf4 \strokec4 ].\cf9 \strokec9 sort\cf4 \strokec4 ((\cf6 \strokec6 a\cf4 \strokec4 , \cf6 \strokec6 b\cf4 \strokec4 ) \cf8 \strokec8 =>\cf4 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 sortOption\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 'name'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 a\cf4 \strokec4 .\cf6 \strokec6 name\cf4 \strokec4 .\cf9 \strokec9 localeCompare\cf4 \strokec4 (\cf6 \strokec6 b\cf4 \strokec4 .\cf6 \strokec6 name\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 sortOption\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 'type'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  (\cf6 \strokec6 a\cf4 \strokec4 .\cf6 \strokec6 type\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ).\cf9 \strokec9 localeCompare\cf4 \strokec4 (\cf6 \strokec6 b\cf4 \strokec4 .\cf6 \strokec6 type\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 sortOption\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 'recent'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 aDate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 getLastPurchaseDate\cf4 \strokec4 (\cf6 \strokec6 a\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 , \cf10 \strokec10 purchases\cf4 \strokec4 ) \cf11 \strokec11 ||\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 bDate\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 getLastPurchaseDate\cf4 \strokec4 (\cf6 \strokec6 b\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 , \cf10 \strokec10 purchases\cf4 \strokec4 ) \cf11 \strokec11 ||\cf4 \strokec4  \cf7 \strokec7 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Date\cf4 \strokec4 (\cf10 \strokec10 bDate\cf4 \strokec4 ) \cf11 \strokec11 -\cf4 \strokec4  \cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Date\cf4 \strokec4 (\cf10 \strokec10 aDate\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 sortOption\cf4 \strokec4  \cf11 \strokec11 ===\cf4 \strokec4  \cf7 \strokec7 'cost'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 aCost\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 getProductPurchaseStats\cf4 \strokec4 (\cf6 \strokec6 a\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 , \cf10 \strokec10 purchases\cf4 \strokec4 ).\cf6 \strokec6 totalCost\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ;\cb1 \
\cb3     \cf8 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 bCost\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  \cf9 \strokec9 getProductPurchaseStats\cf4 \strokec4 (\cf6 \strokec6 b\cf4 \strokec4 .\cf6 \strokec6 id\cf4 \strokec4 , \cf10 \strokec10 purchases\cf4 \strokec4 ).\cf6 \strokec6 totalCost\cf4 \strokec4  \cf11 \strokec11 ||\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ;\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf10 \strokec10 bCost\cf4 \strokec4  \cf11 \strokec11 -\cf4 \strokec4  \cf10 \strokec10 aCost\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf5 \strokec5 return\cf4 \strokec4  \cf13 \strokec13 0\cf4 \strokec4 ;\cb1 \
\cb3 \});\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 // Build a map: productId -> Set of crops it's used on\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 allCropsUsed\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  [\cf11 \strokec11 ...\cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Set\cf4 \strokec4 (\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf12 \strokec12 Object\cf4 \strokec4 .\cf9 \strokec9 values\cf4 \strokec4 (\cf10 \strokec10 productIdToCrops\cf4 \strokec4 )\cb1 \
\cb3     .\cf9 \strokec9 flatMap\cf4 \strokec4 (\cf6 \strokec6 set\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  [\cf11 \strokec11 ...\cf6 \strokec6 set\cf4 \strokec4 ])\cb1 \
\cb3 )];\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf4 \strokec4  \cf10 \strokec10 allVendors\cf4 \strokec4  \cf11 \strokec11 =\cf4 \strokec4  [\cf11 \strokec11 ...\cf8 \strokec8 new\cf4 \strokec4  \cf12 \strokec12 Set\cf4 \strokec4 (\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf10 \strokec10 purchases\cf4 \cb1 \strokec4 \
\cb3     .\cf9 \strokec9 map\cf4 \strokec4 (\cf6 \strokec6 p\cf4 \strokec4  \cf8 \strokec8 =>\cf4 \strokec4  \cf6 \strokec6 p\cf4 \strokec4 .\cf6 \strokec6 vendor\cf4 \strokec4 )\cb1 \
\cb3     .\cf9 \strokec9 filter\cf4 \strokec4 (\cf12 \strokec12 Boolean\cf4 \strokec4 )\cb1 \
\cb3 )];\cb1 \
\
\cb3  \cf5 \strokec5 return\cf4 \strokec4  (\cb1 \
\cb3   \cf14 \strokec14 <\cf8 \strokec8 div\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "p-4"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex items-center justify-between mb-4"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf14 \strokec14 <\cf8 \strokec8 h2\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xl font-semibold"\cf14 \strokec14 >\cf4 \strokec4 Inputs Tracker - \cf8 \strokec8 \{\cf10 \strokec10 cropYear\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 h2\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "bg-blue-600 text-white px-4 py-2 rounded text-sm disabled:opacity-50"\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 disabled\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 selectedProductIds\cf11 \strokec11 .\cf6 \strokec6 length\cf11 \strokec11  === \cf13 \strokec13 0\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11     \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 productsToLog\cf11 \strokec11  = \cf10 \strokec10 selectedProductIds\cf11 \strokec11 .\cf9 \strokec9 map\cf11 \strokec11 (\cf6 \strokec6 id\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\{ \cf6 \strokec6 id\cf11 \strokec11  \}));\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf9 \strokec9 setModalProducts\cf11 \strokec11 (\cf10 \strokec10 productsToLog\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf9 \strokec9 setEditPurchase\cf11 \strokec11 (\cf8 \strokec8 null\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf9 \strokec9 setPurchaseModalOpen\cf11 \strokec11 (\cf8 \strokec8 true\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 \{\cf10 \strokec10 selectedProductIds\cf11 \strokec11 .\cf6 \strokec6 length\cf11 \strokec11  > \cf13 \strokec13 0\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11     ? \cf7 \strokec7 `Log Purchase for \cf8 \strokec8 $\{\cf10 \strokec10 selectedProductIds\cf11 \strokec11 .\cf6 \strokec6 length\cf8 \strokec8 \}\cf7 \strokec7  Selected`\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     : \cf7 \strokec7 'Log Purchase'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 \{\cf2 \strokec2 /* Financial Summary Bar */\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex flex-wrap items-center gap-4 text-sm text-gray-700 mb-4 border-b pb-2"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf14 \strokec14 <\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 span\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "font-semibold"\cf14 \strokec14 >\cf8 \strokec8 \{\cf10 \strokec10 products\cf11 \strokec11 .\cf6 \strokec6 length\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 span\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 \{\cf7 \strokec7 ' of '\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 span\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "font-semibold"\cf14 \strokec14 >\cf8 \strokec8 \{\cf10 \strokec10 allUsedOrPurchasedIds\cf11 \strokec11 .\cf10 \strokec10 size\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 span\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 \{\cf7 \strokec7 ' Products'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cb3   \cf14 \strokec14 <\cf8 \strokec8 div\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border-l pl-4"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 span\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "font-semibold"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3       $\cf8 \strokec8 \{\cf10 \strokec10 purchases\cf11 \strokec11 .\cf9 \strokec9 reduce\cf11 \strokec11 ((\cf6 \strokec6 sum\cf11 \strokec11 , \cf6 \strokec6 p\cf11 \strokec11 ) \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 sum\cf11 \strokec11  + (\cf9 \strokec9 parseFloat\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 cost\cf11 \strokec11 ) || \cf13 \strokec13 0\cf11 \strokec11 ), \cf13 \strokec13 0\cf11 \strokec11 ).\cf9 \strokec9 toLocaleString\cf11 \strokec11 ()\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 </\cf8 \strokec8 span\cf14 \strokec14 >\cf8 \strokec8 \{\cf7 \strokec7 ' '\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3     Purchased year-to-date\cb1 \
\cb3   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cb3   \cf8 \strokec8 \{\cf11 \strokec11 [\cf7 \strokec7 'Chemical'\cf11 \strokec11 , \cf7 \strokec7 'Fertilizer'\cf11 \strokec11 , \cf7 \strokec7 'Seed Treatment'\cf11 \strokec11 , \cf7 \strokec7 'Seed'\cf11 \strokec11 ].\cf9 \strokec9 map\cf11 \strokec11 (\cf6 \strokec6 type\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11     \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 typeCost\cf11 \strokec11  = \cf10 \strokec10 purchases\cf11 \strokec11 .\cf9 \strokec9 reduce\cf11 \strokec11 ((\cf6 \strokec6 sum\cf11 \strokec11 , \cf6 \strokec6 p\cf11 \strokec11 ) \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 prod\cf11 \strokec11  = \cf10 \strokec10 products\cf11 \strokec11 .\cf9 \strokec9 find\cf11 \strokec11 (\cf6 \strokec6 prod\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 prod\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11  === \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 productId\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf5 \strokec5 if\cf11 \strokec11  (!\cf10 \strokec10 prod\cf11 \strokec11  || \cf10 \strokec10 prod\cf11 \strokec11 .\cf6 \strokec6 type\cf11 \strokec11  !== \cf6 \strokec6 type\cf11 \strokec11 ) \cf5 \strokec5 return\cf11 \strokec11  \cf6 \strokec6 sum\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf5 \strokec5 return\cf11 \strokec11  \cf6 \strokec6 sum\cf11 \strokec11  + (\cf9 \strokec9 parseFloat\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 cost\cf11 \strokec11 ) || \cf13 \strokec13 0\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \}, \cf13 \strokec13 0\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11     \cf5 \strokec5 return\cf11 \strokec11  (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 key\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 type\cf8 \strokec8 \}\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border-l pl-4"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf14 \strokec14 <\cf8 \strokec8 span\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "font-semibold"\cf14 \strokec14 >\cf11 \strokec11 $\cf8 \strokec8 \{\cf10 \strokec10 typeCost\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 ()\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 span\cf14 \strokec14 >\cf8 \strokec8 \{\cf7 \strokec7 ' '\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf8 \strokec8 \{\cf6 \strokec6 type\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf14 \cb3 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setIsFilterOpen\cf11 \strokec11 (\cf8 \strokec8 true\cf11 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border border-gray-300 text-sm rounded px-3 py-1 mr-2 flex items-center gap-1"\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf14 \strokec14 <\cf8 \strokec8 span\cf14 \strokec14 >\cf4 \strokec4 Filters\cf14 \strokec14 </\cf8 \strokec8 span\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex justify-between items-center mb-4"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf14 \strokec14 <\cf8 \strokec8 input\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 type\cf11 \strokec11 =\cf7 \strokec7 "text"\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 placeholder\cf11 \strokec11 =\cf7 \strokec7 "Search by product name..."\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border p-2 rounded w-full max-w-md"\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 value\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 filterText\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 onChange\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 (\cf6 \strokec6 e\cf11 \strokec11 ) \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setFilterText\cf11 \strokec11 (\cf6 \strokec6 e\cf11 \strokec11 .\cf6 \strokec6 target\cf11 \strokec11 .\cf6 \strokec6 value\cf11 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf14 \strokec14 />\cf4 \cb1 \strokec4 \
\
\cb3   \cf14 \strokec14 <\cf8 \strokec8 select\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "ml-4 border p-2 rounded"\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 value\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 sortOption\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 onChange\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 (\cf6 \strokec6 e\cf11 \strokec11 ) \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setSortOption\cf11 \strokec11 (\cf6 \strokec6 e\cf11 \strokec11 .\cf6 \strokec6 target\cf11 \strokec11 .\cf6 \strokec6 value\cf11 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 option\cf4 \strokec4  \cf6 \strokec6 value\cf11 \strokec11 =\cf7 \strokec7 "name"\cf14 \strokec14 >\cf4 \strokec4 Alphabetical\cf14 \strokec14 </\cf8 \strokec8 option\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 option\cf4 \strokec4  \cf6 \strokec6 value\cf11 \strokec11 =\cf7 \strokec7 "type"\cf14 \strokec14 >\cf4 \strokec4 Product Type\cf14 \strokec14 </\cf8 \strokec8 option\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 option\cf4 \strokec4  \cf6 \strokec6 value\cf11 \strokec11 =\cf7 \strokec7 "recent"\cf14 \strokec14 >\cf4 \strokec4 Last Purchase (newest)\cf14 \strokec14 </\cf8 \strokec8 option\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 option\cf4 \strokec4  \cf6 \strokec6 value\cf11 \strokec11 =\cf7 \strokec7 "cost"\cf14 \strokec14 >\cf4 \strokec4 Total Cost (highest)\cf14 \strokec14 </\cf8 \strokec8 option\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3   \cf14 \strokec14 </\cf8 \strokec8 select\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf8 \strokec8 \{\cf2 \strokec2 /* DESKTOP TABLE VIEW */\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 div\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "hidden md:block"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3       \cf14 \strokec14 <\cf8 \strokec8 table\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "w-full text-sm border"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 thead\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "bg-gray-100"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3   \cf14 \strokec14 <\cf8 \strokec8 tr\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1 text-center"\cf14 \strokec14 >\cf4 \strokec4 \uc0\u10003 \cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Product\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Type\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Applied\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Purchased\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Remaining\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Avg Unit Price\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Cost\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 th\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-2 py-1"\cf14 \strokec14 >\cf4 \strokec4 Actions\cf14 \strokec14 </\cf8 \strokec8 th\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3   \cf14 \strokec14 </\cf8 \strokec8 tr\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 thead\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3         \cf14 \strokec14 <\cf8 \strokec8 tbody\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3          \cf8 \strokec8 \{\cf10 \strokec10 sortedProducts\cf11 \strokec11 .\cf9 \strokec9 map\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11           \cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 applied\cf11 \strokec11  = \cf10 \strokec10 appliedTotals\cf11 \strokec11 [\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 ];\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 operatorBreakdown\cf11 \strokec11  = \cf10 \strokec10 appliedByOperator\cf11 \strokec11 [\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 ] || \{\};\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedPCF\cf11 \strokec11  = \cf10 \strokec10 operatorBreakdown\cf11 \strokec11 .\cf10 \strokec10 PCF\cf11 \strokec11  || \cf13 \strokec13 0\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedTCF\cf11 \strokec11  = \cf10 \strokec10 operatorBreakdown\cf11 \strokec11 .\cf10 \strokec10 TCF\cf11 \strokec11  || \cf13 \strokec13 0\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastPurchaseDate\cf11 \strokec11  = \cf9 \strokec9 getLastPurchaseDate\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 , \cf10 \strokec10 purchases\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf10 \strokec10 totalPurchased\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf10 \strokec10 totalCost\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf10 \strokec10 avgNormalizedUnitPrice\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf10 \strokec10 avgPurchaseUnitPrice\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 \} = \cf9 \strokec9 getProductPurchaseStats\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 , \cf10 \strokec10 purchases\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 matchingPurchases\cf11 \strokec11  = \cf10 \strokec10 purchases\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   .\cf9 \strokec9 filter\cf11 \strokec11 (\cf6 \strokec6 pur\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 pur\cf11 \strokec11 .\cf6 \strokec6 productId\cf11 \strokec11  === \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11  && \cf6 \strokec6 pur\cf11 \strokec11 .\cf6 \strokec6 date\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   .\cf9 \strokec9 sort\cf11 \strokec11 ((\cf6 \strokec6 a\cf11 \strokec11 , \cf6 \strokec6 b\cf11 \strokec11 ) \cf8 \strokec8 =>\cf11 \strokec11  \cf8 \strokec8 new\cf11 \strokec11  \cf12 \strokec12 Date\cf11 \strokec11 (\cf6 \strokec6 b\cf11 \strokec11 .\cf6 \strokec6 date\cf11 \strokec11 ) - \cf8 \strokec8 new\cf11 \strokec11  \cf12 \strokec12 Date\cf11 \strokec11 (\cf6 \strokec6 a\cf11 \strokec11 .\cf6 \strokec6 date\cf11 \strokec11 ));\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastPurchase\cf11 \strokec11  = \cf10 \strokec10 matchingPurchases\cf11 \strokec11 [\cf13 \strokec13 0\cf11 \strokec11 ];\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastVendor\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 vendorName\cf11 \strokec11  || \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastAmount\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 amount\cf11 \strokec11  || \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastUnit\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 unit\cf11 \strokec11  || \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastCost\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 cost\cf11 \strokec11  ? \cf9 \strokec9 parseFloat\cf11 \strokec11 (\cf10 \strokec10 lastPurchase\cf11 \strokec11 .\cf6 \strokec6 cost\cf11 \strokec11 ).\cf9 \strokec9 toFixed\cf11 \strokec11 (\cf13 \strokec13 2\cf11 \strokec11 ) : \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedAmount\cf11 \strokec11  = \cf10 \strokec10 applied\cf11 \strokec11  ? \cf10 \strokec10 applied\cf11 \strokec11 .\cf6 \strokec6 amount\cf11 \strokec11  : \cf13 \strokec13 0\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 remaining\cf11 \strokec11  = \cf10 \strokec10 totalPurchased\cf11 \strokec11  - \cf10 \strokec10 appliedAmount\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 cost\cf11 \strokec11  = \cf10 \strokec10 totalCost\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11  \cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             \cf5 \strokec5 return\cf11 \strokec11  (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             \cf14 \strokec14 <\cf8 \strokec8 tr\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf6 \strokec6 key\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "bg-white shadow-sm border rounded-md align-top hover:bg-gray-50"\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-center"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 input\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 type\cf11 \strokec11 =\cf7 \strokec7 "checkbox"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 checked\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 selectedProductIds\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 onChange\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf9 \strokec9 setSelectedProductIds\cf11 \strokec11 (\cf6 \strokec6 prev\cf11 \strokec11  \cf8 \strokec8 =>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf6 \strokec6 prev\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             ? \cf6 \strokec6 prev\cf11 \strokec11 .\cf9 \strokec9 filter\cf11 \strokec11 (\cf6 \strokec6 id\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 id\cf11 \strokec11  !== \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             : [...\cf6 \strokec6 prev\cf11 \strokec11 , \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 ]\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 />\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11  \cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                 \cf14 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-blue-600 font-medium text-sm cursor-pointer hover:underline"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                     \cf14 \strokec14 <\cf12 \strokec12 Link\cf11 \strokec11  \cf6 \strokec6 to\cf11 \strokec11 =\cf8 \strokec8 \{\cf7 \strokec7 `/products/\cf8 \strokec8 $\{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf8 \strokec8 \}\cf7 \strokec7 `\cf8 \strokec8 \}\cf14 \strokec14 >\cf8 \strokec8 \{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 name\cf8 \strokec8 \}\cf14 \strokec14 </\cf12 \strokec12 Link\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs text-gray-500 italic"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                     \cf8 \strokec8 \{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 seedsPerUnit\cf11 \strokec11  ? \cf7 \strokec7 `\cf8 \strokec8 $\{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 seedsPerUnit\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 ()\cf8 \strokec8 \}\cf7 \strokec7  seeds/unit`\cf11 \strokec11  : \cf7 \strokec7 ''\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                 \cf14 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                 \cf14 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-sm text-gray-700"\cf14 \strokec14 >\cf8 \strokec8 \{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 type\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                \cf14 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-sm text-right"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 \{\cf10 \strokec10 applied\cf11 \strokec11  ? (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf8 \strokec8 \{\cf10 \strokec10 applied\cf11 \strokec11 .\cf6 \strokec6 amount\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 ()\cf8 \strokec8 \}\cf11 \strokec11  \cf8 \strokec8 \{\cf10 \strokec10 applied\cf11 \strokec11 .\cf6 \strokec6 unit\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs text-gray-500"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         PCF: \cf8 \strokec8 \{\cf10 \strokec10 appliedPCF\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf11 \strokec11 , TCF: \cf8 \strokec8 \{\cf10 \strokec10 appliedTCF\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 </>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   ) : \cf7 \strokec7 '--'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11                \cf14 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-sm text-right"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 \{\cf10 \strokec10 totalPurchased\cf11 \strokec11  ? \cf10 \strokec10 totalPurchased\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \}) : \cf7 \strokec7 '--'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf14 \cb3 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-sm text-right"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf8 \strokec8 \{\cf10 \strokec10 remaining\cf11 \strokec11  ? (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf8 \strokec8 \{\cf10 \strokec10 remaining\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs text-gray-500"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         PCF: \cf8 \strokec8 \{\cf11 \strokec11 (\cf10 \strokec10 totalPurchased\cf11 \strokec11  - \cf10 \strokec10 appliedPCF\cf11 \strokec11 ).\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf11 \strokec11 , TCF: \cf8 \strokec8 \{\cf11 \strokec11 (\cf10 \strokec10 totalPurchased\cf11 \strokec11  - \cf10 \strokec10 appliedTCF\cf11 \strokec11 ).\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 </>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   ) : \cf7 \strokec7 '--'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf14 \cb3 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-sm text-right"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf8 \strokec8 \{\cf10 \strokec10 avgPurchaseUnitPrice\cf11 \strokec11  ? \cf7 \strokec7 `$\cf8 \strokec8 $\{\cf10 \strokec10 avgPurchaseUnitPrice\cf11 \strokec11 .\cf9 \strokec9 toFixed\cf11 \strokec11 (\cf13 \strokec13 2\cf11 \strokec11 )\cf8 \strokec8 \}\cf7 \strokec7 `\cf11 \strokec11  : \cf7 \strokec7 '--'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf14 \cb3 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-sm text-right"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf8 \strokec8 \{\cf10 \strokec10 cost\cf11 \strokec11  ? \cf7 \strokec7 `$\cf8 \strokec8 $\{\cf10 \strokec10 cost\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 minimumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 2\cf11 \strokec11  \})\cf8 \strokec8 \}\cf7 \strokec7 `\cf11 \strokec11  : \cf7 \strokec7 '--'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11                 \cf14 \strokec14 <\cf8 \strokec8 td\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "border px-4 py-3 text-sm text-blue-600 underline text-right"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11                   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex flex-col items-end text-sm"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 \{\cf10 \strokec10 lastPurchaseDate\cf11 \strokec11  && (\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs text-gray-500"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf6 \strokec6 style\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 \{ \cf6 \strokec6 whiteSpace:\cf11 \strokec11  \cf7 \strokec7 'pre-line'\cf11 \strokec11  \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf6 \strokec6 title\cf11 \strokec11 =\cf8 \strokec8 \{\cf7 \strokec7 `Vendor: \cf8 \strokec8 $\{\cf10 \strokec10 lastVendor\cf8 \strokec8 \}\cf15 \strokec15 \\n\cf7 \strokec7 Amount: \cf8 \strokec8 $\{\cf10 \strokec10 lastAmount\cf8 \strokec8 \}\cf7 \strokec7  \cf8 \strokec8 $\{\cf10 \strokec10 lastUnit\cf8 \strokec8 \}\cf15 \strokec15 \\n\cf7 \strokec7 Cost: $\cf8 \strokec8 $\{\cf10 \strokec10 lastCost\cf8 \strokec8 \}\cf7 \strokec7 `\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   Last: \cf8 \strokec8 \{\cf10 \strokec10 lastPurchaseDate\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex flex-col items-end text-sm"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-blue-600 underline"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setModalProducts\cf11 \strokec11 ([\{ \cf6 \strokec6 id:\cf11 \strokec11  \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11  \}]);\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setEditPurchase\cf11 \strokec11 (\cf8 \strokec8 null\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setPurchaseModalOpen\cf11 \strokec11 (\cf8 \strokec8 true\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     Log purchase\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11                 \cf14 \strokec14 </\cf8 \strokec8 td\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               \cf14 \strokec14 </\cf8 \strokec8 tr\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3         \cf14 \strokec14 </\cf8 \strokec8 tbody\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3       \cf14 \strokec14 </\cf8 \strokec8 table\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cb3     \cf8 \strokec8 \{\cf2 \strokec2 /* MOBILE CARD VIEW */\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3     \cf14 \strokec14 <\cf8 \strokec8 div\cf4 \strokec4  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "block md:hidden mt-4 space-y-3"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3       \cf8 \strokec8 \{\cf10 \strokec10 sortedProducts\cf11 \strokec11 .\cf9 \strokec9 map\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11         \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 matchingPurchases\cf11 \strokec11  = \cf10 \strokec10 purchases\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   .\cf9 \strokec9 filter\cf11 \strokec11 (\cf6 \strokec6 pur\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 pur\cf11 \strokec11 .\cf6 \strokec6 productId\cf11 \strokec11  === \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11  && \cf6 \strokec6 pur\cf11 \strokec11 .\cf6 \strokec6 date\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   .\cf9 \strokec9 sort\cf11 \strokec11 ((\cf6 \strokec6 a\cf11 \strokec11 , \cf6 \strokec6 b\cf11 \strokec11 ) \cf8 \strokec8 =>\cf11 \strokec11  \cf8 \strokec8 new\cf11 \strokec11  \cf12 \strokec12 Date\cf11 \strokec11 (\cf6 \strokec6 b\cf11 \strokec11 .\cf6 \strokec6 date\cf11 \strokec11 ) - \cf8 \strokec8 new\cf11 \strokec11  \cf12 \strokec12 Date\cf11 \strokec11 (\cf6 \strokec6 a\cf11 \strokec11 .\cf6 \strokec6 date\cf11 \strokec11 ));\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastPurchase\cf11 \strokec11  = \cf10 \strokec10 matchingPurchases\cf11 \strokec11 [\cf13 \strokec13 0\cf11 \strokec11 ];\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastVendor\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 vendorName\cf11 \strokec11  || \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastAmount\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 amount\cf11 \strokec11  || \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastUnit\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 unit\cf11 \strokec11  || \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastCost\cf11 \strokec11  = \cf10 \strokec10 lastPurchase\cf11 \strokec11 ?.\cf6 \strokec6 cost\cf11 \strokec11  ? \cf9 \strokec9 parseFloat\cf11 \strokec11 (\cf10 \strokec10 lastPurchase\cf11 \strokec11 .\cf6 \strokec6 cost\cf11 \strokec11 ).\cf9 \strokec9 toFixed\cf11 \strokec11 (\cf13 \strokec13 2\cf11 \strokec11 ) : \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 applied\cf11 \strokec11  = \cf10 \strokec10 appliedTotals\cf11 \strokec11 [\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 ];\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 lastPurchaseDate\cf11 \strokec11  = \cf9 \strokec9 getLastPurchaseDate\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 , \cf10 \strokec10 purchases\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \{ \cf10 \strokec10 totalPurchased\cf11 \strokec11 , \cf10 \strokec10 totalCost\cf11 \strokec11 , \cf10 \strokec10 avgUnitPrice\cf11 \strokec11  \} = \cf9 \strokec9 getProductPurchaseStats\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 , \cf10 \strokec10 purchases\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 operatorBreakdown\cf11 \strokec11  = \cf10 \strokec10 appliedByOperator\cf11 \strokec11 [\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 ] || \{\};\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedPCF\cf11 \strokec11  = \cf10 \strokec10 operatorBreakdown\cf11 \strokec11 .\cf10 \strokec10 PCF\cf11 \strokec11  || \cf13 \strokec13 0\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedTCF\cf11 \strokec11  = \cf10 \strokec10 operatorBreakdown\cf11 \strokec11 .\cf10 \strokec10 TCF\cf11 \strokec11  || \cf13 \strokec13 0\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedAmount\cf11 \strokec11  = \cf10 \strokec10 applied\cf11 \strokec11  ? \cf10 \strokec10 applied\cf11 \strokec11 .\cf6 \strokec6 amount\cf11 \strokec11  : \cf13 \strokec13 0\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 remaining\cf11 \strokec11  = \cf10 \strokec10 totalPurchased\cf11 \strokec11  - \cf10 \strokec10 appliedAmount\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 cost\cf11 \strokec11  = \cf10 \strokec10 appliedAmount\cf11 \strokec11  * \cf10 \strokec10 avgUnitPrice\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11        \cf8 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedDisplay\cf11 \strokec11  = \cf10 \strokec10 applied\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   ? \cf7 \strokec7 `\cf8 \strokec8 $\{\cf10 \strokec10 applied\cf11 \strokec11 .\cf6 \strokec6 amount\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 ()\cf8 \strokec8 \}\cf7 \strokec7  \cf8 \strokec8 $\{\cf10 \strokec10 applied\cf11 \strokec11 .\cf6 \strokec6 unit\cf8 \strokec8 \}\cf7 \strokec7  applied`\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   : \cf7 \strokec7 'No usage recorded'\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 const\cf11 \strokec11  \cf10 \strokec10 appliedBreakdown\cf11 \strokec11  = \cf10 \strokec10 applied\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   ? \cf7 \strokec7 `PCF: \cf8 \strokec8 $\{\cf10 \strokec10 appliedPCF\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf7 \strokec7 , TCF: \cf8 \strokec8 $\{\cf10 \strokec10 appliedTCF\cf11 \strokec11 .\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf7 \strokec7 `\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   : \cf7 \strokec7 ''\cf11 \strokec11 ;\cf4 \cb1 \strokec4 \
\
\
\cf11 \cb3 \strokec11         \cf5 \strokec5 return\cf11 \strokec11  (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 key\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf8 \strokec8 \}\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "bg-white border shadow-sm rounded p-3"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs font-semibold text-gray-500 uppercase mb-1"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf8 \strokec8 \{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 type\cf11 \strokec11  || \cf7 \strokec7 'Other'\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex items-center justify-between mb-2"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 input\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 type\cf11 \strokec11 =\cf7 \strokec7 "checkbox"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 checked\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 selectedProductIds\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 onChange\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setSelectedProductIds\cf11 \strokec11 (\cf6 \strokec6 prev\cf11 \strokec11  \cf8 \strokec8 =>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 prev\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           ? \cf6 \strokec6 prev\cf11 \strokec11 .\cf9 \strokec9 filter\cf11 \strokec11 (\cf6 \strokec6 id\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 id\cf11 \strokec11  !== \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           : [...\cf6 \strokec6 prev\cf11 \strokec11 , \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11 ]\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 />\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-sm font-bold text-gray-800"\cf14 \strokec14 >\cf8 \strokec8 \{\cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 name\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-sm text-gray-600 mt-1"\cf14 \strokec14 >\cf8 \strokec8 \{\cf10 \strokec10 appliedDisplay\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 \{\cf10 \strokec10 applied\cf11 \strokec11  && (\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs text-gray-500"\cf14 \strokec14 >\cf8 \strokec8 \{\cf10 \strokec10 appliedBreakdown\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 \{\cf10 \strokec10 applied\cf11 \strokec11  && \cf10 \strokec10 totalPurchased\cf11 \strokec11  > \cf13 \strokec13 0\cf11 \strokec11  && (\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-sm text-gray-600 mt-1"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       Remaining: \cf8 \strokec8 \{\cf11 \strokec11 (\cf10 \strokec10 totalPurchased\cf11 \strokec11  - \cf10 \strokec10 applied\cf11 \strokec11 .\cf6 \strokec6 amount\cf11 \strokec11 ).\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs text-gray-500"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       PCF: \cf8 \strokec8 \{\cf11 \strokec11 (\cf10 \strokec10 totalPurchased\cf11 \strokec11  - \cf10 \strokec10 appliedPCF\cf11 \strokec11 ).\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf11 \strokec11 , TCF: \cf8 \strokec8 \{\cf11 \strokec11 (\cf10 \strokec10 totalPurchased\cf11 \strokec11  - \cf10 \strokec10 appliedTCF\cf11 \strokec11 ).\cf9 \strokec9 toLocaleString\cf11 \strokec11 (\cf8 \strokec8 undefined\cf11 \strokec11 , \{ \cf6 \strokec6 maximumFractionDigits:\cf11 \strokec11  \cf13 \strokec13 1\cf11 \strokec11  \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </>\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\
\
\
\cf11 \cb3 \strokec11   \cf8 \strokec8 \{\cf2 \strokec2 /* \uc0\u9989  INSERT HERE: below appliedDisplay */\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11  \cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-right mt-2"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex flex-col items-end text-sm"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11  \cf8 \strokec8 \{\cf10 \strokec10 lastPurchaseDate\cf11 \strokec11  && (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11  \cf14 \strokec14 <\cf8 \strokec8 div\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-xs text-gray-500"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf6 \strokec6 style\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 \{ \cf6 \strokec6 whiteSpace:\cf11 \strokec11  \cf7 \strokec7 'pre-line'\cf11 \strokec11  \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf6 \strokec6 title\cf11 \strokec11 =\cf8 \strokec8 \{\cf7 \strokec7 `Vendor: \cf8 \strokec8 $\{\cf10 \strokec10 lastVendor\cf8 \strokec8 \}\cf15 \strokec15 \\n\cf7 \strokec7 Amount: \cf8 \strokec8 $\{\cf10 \strokec10 lastAmount\cf8 \strokec8 \}\cf7 \strokec7  \cf8 \strokec8 $\{\cf10 \strokec10 lastUnit\cf8 \strokec8 \}\cf15 \strokec15 \\n\cf7 \strokec7 Cost: $\cf8 \strokec8 $\{\cf10 \strokec10 lastCost\cf8 \strokec8 \}\cf7 \strokec7 `\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   Last: \cf8 \strokec8 \{\cf10 \strokec10 lastPurchaseDate\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-blue-600 underline"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setModalProducts\cf11 \strokec11 ([\{ \cf6 \strokec6 id:\cf11 \strokec11  \cf6 \strokec6 p\cf11 \strokec11 .\cf6 \strokec6 id\cf11 \strokec11  \}]);\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setEditPurchase\cf11 \strokec11 (\cf8 \strokec8 null\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setPurchaseModalOpen\cf11 \strokec11 (\cf8 \strokec8 true\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     Log purchase\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11         );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \})\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 \{\cf10 \strokec10 isFilterOpen\cf11 \strokec11  && (\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "bg-white rounded shadow-lg w-full max-w-md p-6 relative"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setIsFilterOpen\cf11 \strokec11 (\cf8 \strokec8 false\cf11 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "absolute top-2 right-2 text-gray-500 hover:text-black"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \uc0\u10005 \cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 h2\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-lg font-semibold mb-4"\cf14 \strokec14 >\cf11 \strokec11 Filters\cf14 \strokec14 </\cf8 \strokec8 h2\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11       \cf8 \strokec8 \{\cf2 \strokec2 /* Temporary placeholder: filter options go here */\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "space-y-2 text-sm"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 label\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "block text-sm font-medium mb-1"\cf14 \strokec14 >\cf11 \strokec11 Product Type\cf14 \strokec14 </\cf8 \strokec8 label\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex flex-wrap gap-2"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf8 \strokec8 \{\cf11 \strokec11 [\cf7 \strokec7 'Chemical'\cf11 \strokec11 , \cf7 \strokec7 'Fertilizer'\cf11 \strokec11 , \cf7 \strokec7 'Seed Treatment'\cf11 \strokec11 , \cf7 \strokec7 'Seed'\cf11 \strokec11 ].\cf9 \strokec9 map\cf11 \strokec11 (\cf6 \strokec6 type\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 key\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 type\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 className\cf11 \strokec11 =\cf8 \strokec8 \{\cf7 \strokec7 `px-3 py-1 rounded border text-sm \cf8 \strokec8 $\{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf10 \strokec10 filters\cf11 \strokec11 .\cf6 \strokec6 types\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 type\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             ? \cf7 \strokec7 'bg-blue-600 text-white'\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             : \cf7 \strokec7 'bg-white text-gray-700 border-gray-300'\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf8 \strokec8 \}\cf7 \strokec7 `\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf9 \strokec9 setFilters\cf11 \strokec11 (\cf6 \strokec6 prev\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             ...\cf6 \strokec6 prev\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             \cf6 \strokec6 types:\cf11 \strokec11  \cf6 \strokec6 prev\cf11 \strokec11 .\cf6 \strokec6 types\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 type\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               ? \cf6 \strokec6 prev\cf11 \strokec11 .\cf6 \strokec6 types\cf11 \strokec11 .\cf9 \strokec9 filter\cf11 \strokec11 (\cf6 \strokec6 t\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 t\cf11 \strokec11  !== \cf6 \strokec6 type\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               : [...\cf6 \strokec6 prev\cf11 \strokec11 .\cf6 \strokec6 types\cf11 \strokec11 , \cf6 \strokec6 type\cf11 \strokec11 ]\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \}));\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 type\cf11 \strokec11 =\cf7 \strokec7 "button"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf8 \strokec8 \{\cf6 \strokec6 type\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     ))\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 label\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "block text-sm font-medium mb-1"\cf14 \strokec14 >\cf11 \strokec11 Crops\cf14 \strokec14 </\cf8 \strokec8 label\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex flex-wrap gap-2"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11    \cf8 \strokec8 \{\cf10 \strokec10 allCropsUsed\cf11 \strokec11 .\cf9 \strokec9 map\cf11 \strokec11 (\cf6 \strokec6 crop\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 key\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 crop\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 className\cf11 \strokec11 =\cf8 \strokec8 \{\cf7 \strokec7 `px-3 py-1 rounded border text-sm \cf8 \strokec8 $\{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf10 \strokec10 filters\cf11 \strokec11 .\cf6 \strokec6 crops\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 crop\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         ? \cf7 \strokec7 'bg-blue-600 text-white'\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         : \cf7 \strokec7 'bg-white text-gray-700 border-gray-300'\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf8 \strokec8 \}\cf7 \strokec7 `\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf9 \strokec9 setFilters\cf11 \strokec11 (\cf6 \strokec6 prev\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         ...\cf6 \strokec6 prev\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf6 \strokec6 crops:\cf11 \strokec11  \cf6 \strokec6 prev\cf11 \strokec11 .\cf6 \strokec6 crops\cf11 \strokec11 .\cf9 \strokec9 includes\cf11 \strokec11 (\cf6 \strokec6 crop\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           ? \cf6 \strokec6 prev\cf11 \strokec11 .\cf6 \strokec6 crops\cf11 \strokec11 .\cf9 \strokec9 filter\cf11 \strokec11 (\cf6 \strokec6 c\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf6 \strokec6 c\cf11 \strokec11  !== \cf6 \strokec6 crop\cf11 \strokec11 )\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           : [...\cf6 \strokec6 prev\cf11 \strokec11 .\cf6 \strokec6 crops\cf11 \strokec11 , \cf6 \strokec6 crop\cf11 \strokec11 ]\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \}));\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 type\cf11 \strokec11 =\cf7 \strokec7 "button"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf8 \strokec8 \{\cf6 \strokec6 crop\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 ))\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 label\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "block text-sm font-medium mb-1"\cf14 \strokec14 >\cf11 \strokec11 Vendor\cf14 \strokec14 </\cf8 \strokec8 label\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 select\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 value\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 filters\cf11 \strokec11 .\cf6 \strokec6 vendor\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 onChange\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 (\cf6 \strokec6 e\cf11 \strokec11 ) \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setFilters\cf11 \strokec11 (\cf6 \strokec6 prev\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\{ ...\cf6 \strokec6 prev\cf11 \strokec11 , \cf6 \strokec6 vendor:\cf11 \strokec11  \cf6 \strokec6 e\cf11 \strokec11 .\cf6 \strokec6 target\cf11 \strokec11 .\cf6 \strokec6 value\cf11 \strokec11  \}))\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "w-full border rounded p-2 text-sm"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 option\cf11 \strokec11  \cf6 \strokec6 value\cf11 \strokec11 =\cf7 \strokec7 ""\cf14 \strokec14 >\cf11 \strokec11 All Vendors\cf14 \strokec14 </\cf8 \strokec8 option\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf8 \strokec8 \{\cf10 \strokec10 allVendors\cf11 \strokec11 .\cf9 \strokec9 map\cf11 \strokec11 (\cf6 \strokec6 v\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 option\cf11 \strokec11  \cf6 \strokec6 key\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 v\cf8 \strokec8 \}\cf11 \strokec11  \cf6 \strokec6 value\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 v\cf8 \strokec8 \}\cf14 \strokec14 >\cf8 \strokec8 \{\cf6 \strokec6 v\cf8 \strokec8 \}\cf14 \strokec14 </\cf8 \strokec8 option\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     ))\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 select\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf14 \cb3 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex gap-4"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex-1"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 label\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "block text-sm font-medium mb-1"\cf14 \strokec14 >\cf11 \strokec11 Start date\cf14 \strokec14 </\cf8 \strokec8 label\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 input\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 type\cf11 \strokec11 =\cf7 \strokec7 "date"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 value\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 filters\cf11 \strokec11 .\cf6 \strokec6 startDate\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 onChange\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 e\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setFilters\cf11 \strokec11 (\cf6 \strokec6 prev\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\{ ...\cf6 \strokec6 prev\cf11 \strokec11 , \cf6 \strokec6 startDate:\cf11 \strokec11  \cf6 \strokec6 e\cf11 \strokec11 .\cf6 \strokec6 target\cf11 \strokec11 .\cf6 \strokec6 value\cf11 \strokec11  \}))\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "w-full border rounded p-2 text-sm"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 />\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11   \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex-1"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 label\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "block text-sm font-medium mb-1"\cf14 \strokec14 >\cf11 \strokec11 End date\cf14 \strokec14 </\cf8 \strokec8 label\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 <\cf8 \strokec8 input\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 type\cf11 \strokec11 =\cf7 \strokec7 "date"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 value\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 filters\cf11 \strokec11 .\cf6 \strokec6 endDate\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 onChange\cf11 \strokec11 =\cf8 \strokec8 \{\cf6 \strokec6 e\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setFilters\cf11 \strokec11 (\cf6 \strokec6 prev\cf11 \strokec11  \cf8 \strokec8 =>\cf11 \strokec11  (\{ ...\cf6 \strokec6 prev\cf11 \strokec11 , \cf6 \strokec6 endDate:\cf11 \strokec11  \cf6 \strokec6 e\cf11 \strokec11 .\cf6 \strokec6 target\cf11 \strokec11 .\cf6 \strokec6 value\cf11 \strokec11  \}))\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "w-full border rounded p-2 text-sm"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 />\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11       \cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11       \cf14 \strokec14 <\cf8 \strokec8 div\cf11 \strokec11  \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "flex justify-between mt-6"\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf14 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "text-red-600 text-sm"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             \cf9 \strokec9 setFilters\cf11 \strokec11 (\{\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               \cf6 \strokec6 types:\cf11 \strokec11  [],\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               \cf6 \strokec6 crops:\cf11 \strokec11  [],\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               \cf6 \strokec6 vendor:\cf11 \strokec11  \cf7 \strokec7 ''\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               \cf6 \strokec6 startDate:\cf11 \strokec11  \cf7 \strokec7 ''\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               \cf6 \strokec6 endDate:\cf11 \strokec11  \cf7 \strokec7 ''\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11               \cf6 \strokec6 restrictedOnly:\cf11 \strokec11  \cf8 \strokec8 false\cf11 \strokec11 ,\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             \});\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11             \cf9 \strokec9 setIsFilterOpen\cf11 \strokec11 (\cf8 \strokec8 false\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           Clear filters\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf14 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11         \cf14 \strokec14 <\cf8 \strokec8 button\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf6 \strokec6 onClick\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \cf9 \strokec9 setIsFilterOpen\cf11 \strokec11 (\cf8 \strokec8 false\cf11 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           \cf6 \strokec6 className\cf11 \strokec11 =\cf7 \strokec7 "bg-blue-600 text-white px-4 py-2 rounded text-sm"\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11           Apply\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11         \cf14 \strokec14 </\cf8 \strokec8 button\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11       \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 )\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 <\cf12 \strokec12 LogInputsPurchase\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 isOpen\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 purchaseModalOpen\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 onClose\cf11 \strokec11 =\cf8 \strokec8 \{\cf11 \strokec11 () \cf8 \strokec8 =>\cf11 \strokec11  \{\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf11 \cb3 \strokec11     \cf9 \strokec9 setPurchaseModalOpen\cf11 \strokec11 (\cf8 \strokec8 false\cf11 \strokec11 );\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11     \cf9 \strokec9 loadData\cf11 \strokec11 (); \cf2 \strokec2 // Re-fetch Firestore data after modal closes\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11   \}\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 cropYear\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 cropYear\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 initialProducts\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 modalProducts\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 editPurchase\cf11 \strokec11 =\cf8 \strokec8 \{\cf10 \strokec10 editPurchase\cf8 \strokec8 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf14 \cb3 \strokec14 />\cf4 \cb1 \strokec4 \
\
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf14 \strokec14 </\cf8 \strokec8 div\cf14 \strokec14 >\cf4 \cb1 \strokec4 \
\cb3 );\cb1 \
\cb3 \}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 export\cf4 \strokec4  \cf5 \strokec5 default\cf4 \strokec4  \cf9 \strokec9 ProductsTracker\cf4 \strokec4 ;\cb1 \
\
}