<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #598a43; -webkit-text-stroke: #598a43}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #c1c1c1; -webkit-text-stroke: #c1c1c1; min-height: 14.0px}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #d4d69a; -webkit-text-stroke: #d4d69a}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #c1c1c1; -webkit-text-stroke: #c1c1c1}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #42b3ff; -webkit-text-stroke: #42b3ff}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #b76fb3; -webkit-text-stroke: #b76fb3}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #6d6d6d; -webkit-text-stroke: #6d6d6d}
    p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 14.0px}
    span.s1 {font-kerning: none; background-color: #181818}
    span.s2 {font-kerning: none; color: #b76fb3; background-color: #181818; -webkit-text-stroke: 0px #b76fb3}
    span.s3 {font-kerning: none; color: #c1c1c1; background-color: #181818; -webkit-text-stroke: 0px #c1c1c1}
    span.s4 {font-kerning: none; color: #c27e65; background-color: #181818; -webkit-text-stroke: 0px #c27e65}
    span.s5 {font-kerning: none; color: #8cd3fe; background-color: #181818; -webkit-text-stroke: 0px #8cd3fe}
    span.s6 {font-kerning: none}
    span.s7 {font-kerning: none; color: #4689cc; background-color: #181818; -webkit-text-stroke: 0px #4689cc}
    span.s8 {font-kerning: none; color: #42b3ff; background-color: #181818; -webkit-text-stroke: 0px #42b3ff}
    span.s9 {font-kerning: none; color: #cacaca; background-color: #181818; -webkit-text-stroke: 0px #cacaca}
    span.s10 {font-kerning: none; color: #d4d69a; background-color: #181818; -webkit-text-stroke: 0px #d4d69a}
    span.s11 {font-kerning: none; color: #a7c598; background-color: #181818; -webkit-text-stroke: 0px #a7c598}
    span.s12 {font-kerning: none; color: #43c0a0; background-color: #181818; -webkit-text-stroke: 0px #43c0a0}
    span.s13 {font-kerning: none; color: #6d6d6d; background-color: #181818; -webkit-text-stroke: 0px #6d6d6d}
  </style>
</head>
<body>
<p class="p1"><span class="s1">// FieldJobSummaryPage.jsx â€” allows editing of a single jobsByField job without touching the master job</span></p>
<p class="p2"><span class="s2">import</span><span class="s3"> </span><span class="s1">React</span><span class="s3">, { </span><span class="s1">useEffect</span><span class="s3">, </span><span class="s1">useState</span><span class="s3"> } </span><span class="s2">from</span><span class="s3"> </span><span class="s4">'react'</span><span class="s3">;</span></p>
<p class="p2"><span class="s2">import</span><span class="s3"> { </span><span class="s1">useParams</span><span class="s3">, </span><span class="s1">useNavigate</span><span class="s3"> } </span><span class="s2">from</span><span class="s3"> </span><span class="s4">'react-router-dom'</span><span class="s3">;</span></p>
<p class="p3"><span class="s2">import</span><span class="s3"> { </span><span class="s5">db</span><span class="s3"> } </span><span class="s2">from</span><span class="s3"> </span><span class="s1">'../firebase'</span><span class="s3">;</span></p>
<p class="p2"><span class="s2">import</span><span class="s3"> { </span><span class="s1">doc</span><span class="s3">, </span><span class="s1">getDoc</span><span class="s3">, </span><span class="s1">updateDoc</span><span class="s3">, </span><span class="s1">collection</span><span class="s3">, </span><span class="s1">getDocs</span><span class="s3">, </span><span class="s1">query</span><span class="s3">, </span><span class="s1">where</span><span class="s3">, </span><span class="s1">setDoc</span><span class="s3"> } </span><span class="s2">from</span><span class="s3"> </span><span class="s4">'firebase/firestore'</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s7">function</span><span class="s3"> </span><span class="s1">FieldJobSummaryPage</span><span class="s3">() {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s1"> { </span><span class="s8">jobId</span><span class="s1"> } </span><span class="s9">=</span><span class="s1"> </span><span class="s10">useParams</span><span class="s1">();</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">navigate</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">useNavigate</span><span class="s3">();</span></p>
<p class="p7"><span class="s7">const</span><span class="s3"> [</span><span class="s1">field</span><span class="s3">, </span><span class="s1">setField</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s7">null</span><span class="s3">);</span></p>
<p class="p7"><span class="s7">const</span><span class="s3"> [</span><span class="s1">notes</span><span class="s3">, </span><span class="s1">setNotes</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s4">''</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s1"> [</span><span class="s8">job</span><span class="s1">, </span><span class="s8">setJob</span><span class="s1">] </span><span class="s9">=</span><span class="s1"> </span><span class="s10">useState</span><span class="s1">(</span><span class="s7">null</span><span class="s1">);</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">usedProductIds</span><span class="s3">, </span><span class="s1">setUsedProductIds</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">([]);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">productsList</span><span class="s3">, </span><span class="s1">setProductsList</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">([]);</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">saving</span><span class="s3">, </span><span class="s1">setSaving</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s7">false</span><span class="s3">);</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">vendors</span><span class="s3">, </span><span class="s1">setVendors</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">([]);</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">applicators</span><span class="s3">, </span><span class="s1">setApplicators</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">([]);</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">generatePdf</span><span class="s3">, </span><span class="s1">setGeneratePdf</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s7">false</span><span class="s3">);</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">originalJob</span><span class="s3">, </span><span class="s1">setOriginalJob</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s7">null</span><span class="s3">);</span></p>
<p class="p7"><span class="s7">const</span><span class="s3"> [</span><span class="s1">fieldBoundary</span><span class="s3">, </span><span class="s1">setFieldBoundary</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s7">null</span><span class="s3">);</span></p>
<p class="p7"><span class="s7">const</span><span class="s3"> [</span><span class="s1">waterVolume</span><span class="s3">, </span><span class="s1">setWaterVolume</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s7">null</span><span class="s3">);</span></p>
<p class="p7"><span class="s7">const</span><span class="s3"> [</span><span class="s1">jobTypesList</span><span class="s3">, </span><span class="s1">setJobTypesList</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">([]);</span></p>
<p class="p7"><span class="s7">const</span><span class="s3"> [</span><span class="s1">passes</span><span class="s3">, </span><span class="s1">setPasses</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s10">useState</span><span class="s3">(</span><span class="s11">1</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s7">const</span><span class="s3"> </span><span class="s8">isLeveeJob</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s5">job</span><span class="s3">?.</span><span class="s5">jobType</span><span class="s3">?.</span><span class="s5">name</span><span class="s3">?.</span><span class="s1">toLowerCase</span><span class="s3">().</span><span class="s1">includes</span><span class="s3">(</span><span class="s4">'levee'</span><span class="s3">) </span><span class="s9">||</span><span class="s3"> </span><span class="s5">job</span><span class="s3">?.</span><span class="s5">jobType</span><span class="s3">?.</span><span class="s5">name</span><span class="s3">?.</span><span class="s1">toLowerCase</span><span class="s3">().</span><span class="s1">includes</span><span class="s3">(</span><span class="s4">'pack'</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s7">const</span><span class="s3"> </span><span class="s1">getJobTypeName</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span><span class="s5">job</span><span class="s3">) </span><span class="s7">=&gt;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">typeof</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'string'</span><span class="s3"> </span><span class="s9">?</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3"> </span><span class="s9">:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3">?.</span><span class="s1">name</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">''</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s1">useEffect</span><span class="s3">(() </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">loadJobTypes</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s7">async</span><span class="s3"> () </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">snap</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s2">await</span><span class="s3"> </span><span class="s1">getDocs</span><span class="s3">(</span><span class="s1">collection</span><span class="s3">(</span><span class="s5">db</span><span class="s3">, </span><span class="s4">'jobTypes'</span><span class="s3">));</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">rawTypes</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s5">snap</span><span class="s1">.</span><span class="s5">docs</span><span class="s1">.</span><span class="s10">map</span><span class="s1">(</span><span class="s5">doc</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> ({ </span><span class="s5">id:</span><span class="s1"> </span><span class="s5">doc</span><span class="s1">.</span><span class="s5">id</span><span class="s1">, </span><span class="s9">...</span><span class="s5">doc</span><span class="s1">.</span><span class="s10">data</span><span class="s1">() }));</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">flattenedTypes</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s5">rawTypes</span><span class="s3">.</span><span class="s10">flatMap</span><span class="s3">((</span><span class="s5">type</span><span class="s3">) </span><span class="s7">=&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>(</span><span class="s5">type</span><span class="s1">.</span><span class="s5">subTypes</span><span class="s1"> </span><span class="s9">||</span><span class="s1"> []).</span><span class="s10">map</span><span class="s1">(</span><span class="s5">sub</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> ({</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s9">...</span><span class="s5">sub</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s1">parentName:</span><span class="s3"> </span><span class="s1">type</span><span class="s3">.</span><span class="s1">name</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}))</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">setJobTypesList</span><span class="s3">(</span><span class="s5">flattenedTypes</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">loadJobTypes</span><span class="s3">();</span></p>
<p class="p6"><span class="s1">}, []);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">useEffect</span><span class="s3">(() </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">loadVendorsAndApplicators</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s7">async</span><span class="s3"> () </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> [</span><span class="s1">vendorSnap</span><span class="s3">, </span><span class="s1">applicatorSnap</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s2">await</span><span class="s3"> </span><span class="s12">Promise</span><span class="s3">.</span><span class="s10">all</span><span class="s3">([</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">getDocs</span><span class="s3">(</span><span class="s1">collection</span><span class="s3">(</span><span class="s5">db</span><span class="s3">, </span><span class="s4">'vendors'</span><span class="s3">)),</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">getDocs</span><span class="s3">(</span><span class="s1">collection</span><span class="s3">(</span><span class="s5">db</span><span class="s3">, </span><span class="s4">'applicators'</span><span class="s3">))</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>]);</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s10">setVendors</span><span class="s3">(</span><span class="s1">vendorSnap</span><span class="s3">.</span><span class="s1">docs</span><span class="s3">.</span><span class="s10">map</span><span class="s3">(</span><span class="s1">doc</span><span class="s3"> </span><span class="s7">=&gt;</span><span class="s3"> </span><span class="s1">doc</span><span class="s3">.</span><span class="s10">data</span><span class="s3">().</span><span class="s1">name</span><span class="s3">));</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s10">setApplicators</span><span class="s3">(</span><span class="s1">applicatorSnap</span><span class="s3">.</span><span class="s1">docs</span><span class="s3">.</span><span class="s10">map</span><span class="s3">(</span><span class="s1">doc</span><span class="s3"> </span><span class="s7">=&gt;</span><span class="s3"> </span><span class="s1">doc</span><span class="s3">.</span><span class="s10">data</span><span class="s3">().</span><span class="s1">name</span><span class="s3">));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">loadVendorsAndApplicators</span><span class="s3">();</span></p>
<p class="p6"><span class="s1">}, []);</span></p>
<p class="p5"><span class="s1">useEffect</span><span class="s3">(() </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">loadUsedProducts</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s7">async</span><span class="s3"> () </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s9">!</span><span class="s1">job</span><span class="s3">?.</span><span class="s1">jobType</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s9">!</span><span class="s1">job</span><span class="s3">?.</span><span class="s1">cropYear</span><span class="s3">) </span><span class="s2">return</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">q</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s10">query</span><span class="s1">(</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s10">collection</span><span class="s1">(</span><span class="s5">db</span><span class="s1">, </span><span class="s4">'jobs'</span><span class="s1">),</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s10">where</span><span class="s1">(</span><span class="s4">'jobType'</span><span class="s1">, </span><span class="s4">'=='</span><span class="s1">, </span><span class="s5">job</span><span class="s1">.</span><span class="s5">jobType</span><span class="s1">),</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s10">where</span><span class="s3">(</span><span class="s1">'cropYear'</span><span class="s3">, </span><span class="s1">'=='</span><span class="s3">, </span><span class="s5">job</span><span class="s3">.</span><span class="s5">cropYear</span><span class="s3">)</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">snap</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s2">await</span><span class="s1"> </span><span class="s10">getDocs</span><span class="s1">(</span><span class="s5">q</span><span class="s1">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">ids</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s7">new</span><span class="s1"> </span><span class="s10">Set</span><span class="s1">();</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">snap</span><span class="s1">.</span><span class="s10">forEach</span><span class="s1">(</span><span class="s5">doc</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">jobData</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s5">doc</span><span class="s1">.</span><span class="s10">data</span><span class="s1">();</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">products</span><span class="s3">?.</span><span class="s10">forEach</span><span class="s3">(</span><span class="s1">p</span><span class="s3"> </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s1">p</span><span class="s3">.</span><span class="s1">productId</span><span class="s3">) </span><span class="s1">ids</span><span class="s3">.</span><span class="s10">add</span><span class="s3">(</span><span class="s1">p</span><span class="s3">.</span><span class="s1">productId</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">setUsedProductIds</span><span class="s3">(</span><span class="s5">Array</span><span class="s3">.</span><span class="s1">from</span><span class="s3">(</span><span class="s5">ids</span><span class="s3">));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">loadUsedProducts</span><span class="s3">();</span></p>
<p class="p2"><span class="s3">}, [</span><span class="s1">job</span><span class="s3">?.</span><span class="s1">jobType</span><span class="s3">, </span><span class="s1">job</span><span class="s3">?.</span><span class="s1">cropYear</span><span class="s3">]);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â </span></span><span class="s1">useEffect</span><span class="s3">(() </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">const</span><span class="s3"> </span><span class="s10">fetchData</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">async</span><span class="s3"> () </span><span class="s1">=&gt;</span><span class="s3"> {</span></p>
<p class="p6"><span class="s7">const</span><span class="s1"> </span><span class="s8">jobSnap</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s2">await</span><span class="s1"> </span><span class="s10">getDoc</span><span class="s1">(</span><span class="s10">doc</span><span class="s1">(</span><span class="s5">db</span><span class="s1">, </span><span class="s4">'jobsByField'</span><span class="s1">, </span><span class="s5">jobId</span><span class="s1">));</span></p>
<p class="p6"><span class="s2">if</span><span class="s1"> (</span><span class="s5">jobSnap</span><span class="s1">.</span><span class="s10">exists</span><span class="s1">()) {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">jobData</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> { </span><span class="s1">id:</span><span class="s3"> </span><span class="s1">jobSnap</span><span class="s3">.</span><span class="s1">id</span><span class="s3">, </span><span class="s9">...</span><span class="s1">jobSnap</span><span class="s3">.</span><span class="s10">data</span><span class="s3">() };</span></p>
<p class="p2"><span class="s10">setPasses</span><span class="s3">(</span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">passes</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s11">1</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">parsedPolygon</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s7">typeof</span><span class="s3"> </span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'string'</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">?</span><span class="s3"> </span><span class="s8">JSON</span><span class="s3">.</span><span class="s10">parse</span><span class="s3">(</span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3">)</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">:</span><span class="s3"> </span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">normalizedJobType</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s7">typeof</span><span class="s3"> </span><span class="s5">jobData</span><span class="s3">.</span><span class="s5">jobType</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'string'</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">?</span><span class="s3"> { </span><span class="s1">name:</span><span class="s3"> </span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3"> }</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">:</span><span class="s3"> </span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">setJob</span><span class="s3">({</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">...</span><span class="s1">jobData</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">jobType:</span><span class="s3"> </span><span class="s1">normalizedJobType</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">drawnPolygon:</span><span class="s3"> </span><span class="s1">parsedPolygon</span><span class="s3">,</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s10">setNotes</span><span class="s3">(</span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">notes</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">''</span><span class="s3">);</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s10">setWaterVolume</span><span class="s3">(</span><span class="s1">jobData</span><span class="s3">.</span><span class="s1">waterVolume</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s11">0</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">setOriginalJob</span><span class="s3">(</span><span class="s5">jobData</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">// ğŸ‘‡ Fetch the full field boundary based on fieldId</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">fieldSnap</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s2">await</span><span class="s1"> </span><span class="s10">getDoc</span><span class="s1">(</span><span class="s10">doc</span><span class="s1">(</span><span class="s5">db</span><span class="s1">, </span><span class="s4">'fields'</span><span class="s1">, </span><span class="s5">jobData</span><span class="s1">.</span><span class="s5">fieldId</span><span class="s1">));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s2">if</span><span class="s1"> (</span><span class="s5">fieldSnap</span><span class="s1">.</span><span class="s10">exists</span><span class="s1">()) {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">fieldData</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> { </span><span class="s1">id:</span><span class="s3"> </span><span class="s1">fieldSnap</span><span class="s3">.</span><span class="s1">id</span><span class="s3">, </span><span class="s9">...</span><span class="s1">fieldSnap</span><span class="s3">.</span><span class="s10">data</span><span class="s3">() };</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s10">setField</span><span class="s3">(</span><span class="s1">fieldData</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">// ğŸ› ï¸ Parse geojson safely</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">let</span><span class="s3"> </span><span class="s1">geo</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">fieldData</span><span class="s3">.</span><span class="s1">boundary</span><span class="s3">?.</span><span class="s1">geojson</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s7">null</span><span class="s3">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s1"> (</span><span class="s7">typeof</span><span class="s1"> </span><span class="s5">geo</span><span class="s1"> </span><span class="s9">===</span><span class="s1"> </span><span class="s4">'string'</span><span class="s1">) {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s2">try</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">geo</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s8">JSON</span><span class="s1">.</span><span class="s10">parse</span><span class="s1">(</span><span class="s5">geo</span><span class="s1">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>} </span><span class="s2">catch</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">geo</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s7">null</span><span class="s1">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">setFieldBoundary</span><span class="s3">(</span><span class="s5">geo</span><span class="s3">);</span></p>
<p class="p6"><span class="s1">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">productsSnap</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s2">await</span><span class="s3"> </span><span class="s1">getDocs</span><span class="s3">(</span><span class="s1">collection</span><span class="s3">(</span><span class="s5">db</span><span class="s3">, </span><span class="s4">'products'</span><span class="s3">));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s10">setProductsList</span><span class="s1">(</span><span class="s5">productsSnap</span><span class="s1">.</span><span class="s5">docs</span><span class="s1">.</span><span class="s10">map</span><span class="s1">(</span><span class="s5">d</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> ({ </span><span class="s5">id:</span><span class="s1"> </span><span class="s5">d</span><span class="s1">.</span><span class="s5">id</span><span class="s1">, </span><span class="s9">...</span><span class="s5">d</span><span class="s1">.</span><span class="s10">data</span><span class="s1">() })));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">fetchData</span><span class="s3">();</span></p>
<p class="p6"><span class="s1">}, [</span><span class="s5">jobId</span><span class="s1">]);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s1">useEffect</span><span class="s3">(() </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">updated</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">location</span><span class="s3">.</span><span class="s1">state</span><span class="s3">?.</span><span class="s1">updatedField</span><span class="s3">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s1"> (</span><span class="s5">updated</span><span class="s1">) {</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">console</span><span class="s3">.</span><span class="s10">log</span><span class="s3">(</span><span class="s1">'ğŸ“¥ Applying updatedField from location.state:'</span><span class="s3">, </span><span class="s5">updated</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">parsedPolygon</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s7">typeof</span><span class="s3"> </span><span class="s1">updated</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'string'</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s9">?</span><span class="s3"> </span><span class="s8">JSON</span><span class="s3">.</span><span class="s10">parse</span><span class="s3">(</span><span class="s1">updated</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3">)</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s9">:</span><span class="s3"> </span><span class="s1">updated</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s10">setJob</span><span class="s1">(</span><span class="s5">prev</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> ({</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s9">...</span><span class="s5">prev</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">drawnPolygon:</span><span class="s3"> </span><span class="s1">parsedPolygon</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">drawnAcres:</span><span class="s3"> </span><span class="s1">updated</span><span class="s3">.</span><span class="s1">drawnAcres</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">acres:</span><span class="s3"> </span><span class="s1">updated</span><span class="s3">.</span><span class="s1">drawnAcres</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p2"><span class="s3">}, [</span><span class="s1">location</span><span class="s3">.</span><span class="s1">state</span><span class="s3">]);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">handleProductChange</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span><span class="s5">index</span><span class="s3">, </span><span class="s5">field</span><span class="s3">, </span><span class="s5">value</span><span class="s3">) </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">updated</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> [</span><span class="s9">...</span><span class="s5">job</span><span class="s1">.</span><span class="s5">products</span><span class="s1">];</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">updated</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s1">field</span><span class="s3">] </span><span class="s9">=</span><span class="s3"> </span><span class="s1">value</span><span class="s3">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s10">setJob</span><span class="s3">(</span><span class="s1">prev</span><span class="s3"> </span><span class="s7">=&gt;</span><span class="s3"> ({ </span><span class="s9">...</span><span class="s1">prev</span><span class="s3">, </span><span class="s1">products:</span><span class="s3"> </span><span class="s1">updated</span><span class="s3"> }));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">const</span><span class="s3"> </span><span class="s10">handleSave</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">async</span><span class="s3"> () </span><span class="s1">=&gt;</span><span class="s3"> {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">setSaving</span><span class="s3">(</span><span class="s7">true</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">shouldBreakFromGroup</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">originalJob</span><span class="s3">.</span><span class="s1">vendor</span><span class="s3"> </span><span class="s9">!==</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">vendor</span><span class="s3"> </span><span class="s9">||</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">originalJob</span><span class="s3">.</span><span class="s1">applicator</span><span class="s3"> </span><span class="s9">!==</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">applicator</span><span class="s3"> </span><span class="s9">||</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">originalJob</span><span class="s3">.</span><span class="s1">jobDate</span><span class="s3"> </span><span class="s9">!==</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">jobDate</span><span class="s3"> </span><span class="s9">||</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s8">JSON</span><span class="s3">.</span><span class="s10">stringify</span><span class="s3">(</span><span class="s1">originalJob</span><span class="s3">.</span><span class="s1">products</span><span class="s3">) </span><span class="s9">!==</span><span class="s3"> </span><span class="s8">JSON</span><span class="s3">.</span><span class="s10">stringify</span><span class="s3">(</span><span class="s1">job</span><span class="s3">.</span><span class="s1">products</span><span class="s3">)</span></p>
<p class="p6"><span class="s1">);</span></p>
<p class="p2"><span class="s2">if</span><span class="s3"> (</span><span class="s9">!</span><span class="s1">shouldBreakFromGroup</span><span class="s3">) {</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">cleanedDrawnPolygon</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s7">typeof</span><span class="s3"> </span><span class="s5">job</span><span class="s3">.</span><span class="s5">drawnPolygon</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'object'</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">?</span><span class="s3"> </span><span class="s8">JSON</span><span class="s3">.</span><span class="s10">stringify</span><span class="s3">(</span><span class="s1">job</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3">)</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s2">await</span><span class="s3"> </span><span class="s10">updateDoc</span><span class="s3">(</span><span class="s10">doc</span><span class="s3">(</span><span class="s5">db</span><span class="s3">, </span><span class="s1">'jobsByField'</span><span class="s3">, </span><span class="s5">job</span><span class="s3">.</span><span class="s5">id</span><span class="s3">), {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s9">...</span><span class="s5">job</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">drawnPolygon:</span><span class="s3"> </span><span class="s1">cleanedDrawnPolygon</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">waterVolume:</span><span class="s3"> </span><span class="s1">waterVolume</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s11">0</span><span class="s3">,</span></p>
<p class="p6"><span class="s1">});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">// ğŸ‘‡ Keep master group job in sync</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s1">job</span><span class="s3">.</span><span class="s1">linkedToJobId</span><span class="s3">) {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">groupRef</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s10">doc</span><span class="s3">(</span><span class="s1">db</span><span class="s3">, </span><span class="s4">'jobs'</span><span class="s3">, </span><span class="s1">job</span><span class="s3">.</span><span class="s1">linkedToJobId</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">groupSnap</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s2">await</span><span class="s1"> </span><span class="s10">getDoc</span><span class="s1">(</span><span class="s5">groupRef</span><span class="s1">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s2">if</span><span class="s1"> (</span><span class="s5">groupSnap</span><span class="s1">.</span><span class="s10">exists</span><span class="s1">()) {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">groupData</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s5">groupSnap</span><span class="s1">.</span><span class="s10">data</span><span class="s1">();</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">updatedFields</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> (</span><span class="s5">groupData</span><span class="s1">.</span><span class="s5">fields</span><span class="s1"> </span><span class="s9">||</span><span class="s1"> []).</span><span class="s10">map</span><span class="s1">(</span><span class="s5">f</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s2">if</span><span class="s1"> (</span><span class="s5">f</span><span class="s1">.</span><span class="s5">id</span><span class="s1"> </span><span class="s9">!==</span><span class="s1"> </span><span class="s5">job</span><span class="s1">.</span><span class="s5">fieldId</span><span class="s1">) </span><span class="s2">return</span><span class="s1"> </span><span class="s5">f</span><span class="s1">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  </span></span><span class="s2">return</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s9">...</span><span class="s5">f</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">status:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">status</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">'Planned'</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">drawnPolygon:</span><span class="s3"> </span><span class="s1">cleanedDrawnPolygon</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">drawnAcres:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">drawnAcres</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s1">f</span><span class="s3">.</span><span class="s1">drawnAcres</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">acres:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">acres</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s1">f</span><span class="s3">.</span><span class="s1">acres</span></p>
<p class="p6"><span class="s1">};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s2">await</span><span class="s1"> </span><span class="s10">setDoc</span><span class="s1">(</span><span class="s5">groupRef</span><span class="s1">, {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s9">...</span><span class="s1">groupData</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">fields:</span><span class="s3"> </span><span class="s1">updatedFields</span><span class="s3">.</span><span class="s10">map</span><span class="s3">(</span><span class="s1">f</span><span class="s3"> </span><span class="s7">=&gt;</span><span class="s3"> ({</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s9">...</span><span class="s5">f</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">drawnPolygon:</span><span class="s3"> </span><span class="s1">f</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s7">null</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">drawnAcres:</span><span class="s3"> </span><span class="s1">f</span><span class="s3">.</span><span class="s1">drawnAcres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s7">null</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">acres:</span><span class="s3"> </span><span class="s1">f</span><span class="s3">.</span><span class="s1">acres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s11">0</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">crop:</span><span class="s3"> </span><span class="s1">f</span><span class="s3">.</span><span class="s1">crop</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s4">''</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">fieldName:</span><span class="s3"> </span><span class="s1">f</span><span class="s3">.</span><span class="s1">fieldName</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s4">''</span><span class="s3">,</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>}))</span></p>
<p class="p6"><span class="s1">});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p2"><span class="s2">if</span><span class="s3"> (</span><span class="s1">generatePdf</span><span class="s3">) {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s2">try</span><span class="s1"> {</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> { </span><span class="s8">generatePDFBlob</span><span class="s3"> } </span><span class="s9">=</span><span class="s3"> </span><span class="s2">await</span><span class="s3"> </span><span class="s7">import</span><span class="s3">(</span><span class="s1">'../utils/generatePDF'</span><span class="s3">);</span></p>
<p class="p6"><span class="s7">const</span><span class="s1"> </span><span class="s8">fieldSnap</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s2">await</span><span class="s1"> </span><span class="s10">getDoc</span><span class="s1">(</span><span class="s10">doc</span><span class="s1">(</span><span class="s5">db</span><span class="s1">, </span><span class="s4">'fields'</span><span class="s1">, </span><span class="s5">job</span><span class="s1">.</span><span class="s5">fieldId</span><span class="s1">));</span></p>
<p class="p2"><span class="s7">const</span><span class="s3"> </span><span class="s8">fieldData</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">fieldSnap</span><span class="s3">.</span><span class="s10">exists</span><span class="s3">() </span><span class="s9">?</span><span class="s3"> </span><span class="s1">fieldSnap</span><span class="s3">.</span><span class="s10">data</span><span class="s3">() </span><span class="s9">:</span><span class="s3"> {};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p7"><span class="s7">const</span><span class="s3"> </span><span class="s1">fullJob</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s9">...</span><span class="s5">job</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">notes</span><span class="s3">,</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">fields:</span><span class="s3"> [</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>{</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">id:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">fieldId</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">fieldName:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">fieldName</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">acres:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">acres</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">drawnAcres:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">drawnAcres</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">drawnPolygon:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3">,</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s9">...</span><span class="s1">fieldData</span><span class="s3">,</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>],</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">acres:</span><span class="s3"> { </span><span class="s1">[</span><span class="s8">job</span><span class="s1">.fieldId]:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">acres</span><span class="s3"> },</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">fieldIds:</span><span class="s3"> [</span><span class="s8">job</span><span class="s3">.</span><span class="s1">fieldId</span><span class="s3">],</span></p>
<p class="p6"><span class="s1">};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s7">const</span><span class="s3"> </span><span class="s8">blob</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s2">await</span><span class="s3"> </span><span class="s1">generatePDFBlob</span><span class="s3">(</span><span class="s8">fullJob</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">url</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s12">URL</span><span class="s3">.</span><span class="s1">createObjectURL</span><span class="s3">(</span><span class="s8">blob</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">link</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s5">document</span><span class="s3">.</span><span class="s1">createElement</span><span class="s3">(</span><span class="s4">'a'</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s8">link</span><span class="s1">.</span><span class="s5">href</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s8">url</span><span class="s1">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s8">link</span><span class="s3">.</span><span class="s1">download</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s4">`FieldJob_</span><span class="s7">${</span><span class="s8">job</span><span class="s9">.</span><span class="s1">fieldName</span><span class="s9"> || </span><span class="s8">job</span><span class="s9">.</span><span class="s1">id</span><span class="s7">}</span><span class="s4">.pdf`</span><span class="s3">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">document</span><span class="s3">.</span><span class="s1">body</span><span class="s3">.</span><span class="s10">appendChild</span><span class="s3">(</span><span class="s8">link</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s8">link</span><span class="s1">.</span><span class="s10">click</span><span class="s1">();</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">document</span><span class="s3">.</span><span class="s1">body</span><span class="s3">.</span><span class="s10">removeChild</span><span class="s3">(</span><span class="s8">link</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>} </span><span class="s2">catch</span><span class="s1"> (</span><span class="s5">err</span><span class="s1">) {</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">console</span><span class="s3">.</span><span class="s10">error</span><span class="s3">(</span><span class="s1">'PDF generation failed:'</span><span class="s3">, </span><span class="s5">err</span><span class="s3">);</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s10">alert</span><span class="s3">(</span><span class="s1">'Job saved, but PDF failed to generate.'</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p6"><span class="s1">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">navigate</span><span class="s3">(</span><span class="s4">'/jobs'</span><span class="s3">);</span></p>
<p class="p9"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">return</span><span class="s3">;</span></p>
<p class="p6"><span class="s1">}</span></p>
<p class="p1"><span class="s1">// ğŸ†• Handle breakaway from group</span></p>
<p class="p1"><span class="s7">const</span><span class="s3"> </span><span class="s8">newGroupedId</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s4">`</span><span class="s7">${</span><span class="s8">job</span><span class="s9">.</span><span class="s5">id</span><span class="s7">}</span><span class="s4">_solo`</span><span class="s3">; </span><span class="s1">// unique ID to avoid conflict</span></p>
<p class="p7"><span class="s7">const</span><span class="s3"> </span><span class="s1">newGroupedJob</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> {</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s5">jobId:</span><span class="s3"> </span><span class="s1">newGroupedId</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">jobType:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">vendor:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">vendor</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">applicator:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">applicator</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">jobDate:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">jobDate</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">cropYear:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">cropYear</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">products:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">products</span><span class="s3">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">Â Â </span></span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">status:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">status</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">notes</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">passes:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">?.</span><span class="s1">jobType</span><span class="s3">?.</span><span class="s1">parentName</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Tillage'</span><span class="s3"> </span><span class="s9">?</span><span class="s3"> </span><span class="s8">passes</span><span class="s3"> </span><span class="s9">:</span><span class="s3"> </span><span class="s7">undefined</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">waterVolume</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">fieldIds:</span><span class="s3"> [</span><span class="s8">job</span><span class="s3">.</span><span class="s1">fieldId</span><span class="s3">],</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">fields:</span><span class="s3"> [</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>{</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">id:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">fieldId</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">fieldName:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">fieldName</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">drawnPolygon:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">drawnPolygon</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s7">null</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">acres:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">drawnAcres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">acres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s11">0</span><span class="s3">,</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">crop:</span><span class="s1"> </span><span class="s8">job</span><span class="s1">.</span><span class="s5">crop</span><span class="s1"> </span><span class="s9">??</span><span class="s1"> </span><span class="s4">''</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">riceLeveeAcres:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">riceLeveeAcres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s7">null</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">beanLeveeAcres:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">beanLeveeAcres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s7">null</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>],</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">acres:</span><span class="s3"> {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">[</span><span class="s8">job</span><span class="s1">.fieldId]:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">drawnAcres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">acres</span><span class="s3"> </span><span class="s9">??</span><span class="s3"> </span><span class="s11">0</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>},</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">timestamp:</span><span class="s3"> </span><span class="s12">Date</span><span class="s3">.</span><span class="s10">now</span><span class="s3">()</span></p>
<p class="p6"><span class="s1">};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p7"><span class="s2">await</span><span class="s3"> </span><span class="s10">setDoc</span><span class="s3">(</span><span class="s10">doc</span><span class="s3">(</span><span class="s1">db</span><span class="s3">, </span><span class="s4">'jobs'</span><span class="s3">, </span><span class="s1">newGroupedId</span><span class="s3">), </span><span class="s1">newGroupedJob</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s2">await</span><span class="s3"> </span><span class="s10">updateDoc</span><span class="s3">(</span><span class="s10">doc</span><span class="s3">(</span><span class="s8">db</span><span class="s3">, </span><span class="s1">'jobsByField'</span><span class="s3">, </span><span class="s8">job</span><span class="s3">.</span><span class="s5">id</span><span class="s3">), {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s9">...</span><span class="s8">job</span><span class="s1">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">linkedToJobId:</span><span class="s3"> </span><span class="s8">newGroupedId</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">notes</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">passes:</span><span class="s3"> </span><span class="s8">job</span><span class="s3">?.</span><span class="s1">jobType</span><span class="s3">?.</span><span class="s1">parentName</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Tillage'</span><span class="s3"> </span><span class="s9">?</span><span class="s3"> </span><span class="s8">passes</span><span class="s3"> </span><span class="s9">:</span><span class="s3"> </span><span class="s7">undefined</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">waterVolume</span></p>
<p class="p6"><span class="s1">});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p8"><span class="s1">const</span><span class="s3"> </span><span class="s10">handleSave</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">async</span><span class="s3"> () </span><span class="s1">=&gt;</span><span class="s3"> {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">setSaving</span><span class="s3">(</span><span class="s7">true</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">shouldBreakFromGroup</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">originalJob</span><span class="s3">.</span><span class="s5">vendor</span><span class="s3"> </span><span class="s9">!==</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s5">vendor</span><span class="s3"> </span><span class="s9">||</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s8">originalJob</span><span class="s3">.</span><span class="s1">applicator</span><span class="s3"> </span><span class="s9">!==</span><span class="s3"> </span><span class="s8">job</span><span class="s3">.</span><span class="s1">applicator</span><span class="s3"> </span><span class="s9">||</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">originalJob</span><span class="s3">.</span><span class="s5">jobDate</span><span class="s3"> </span><span class="s9">!==</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s5">jobDate</span><span class="s3"> </span><span class="s9">||</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">JSON</span><span class="s3">.</span><span class="s10">stringify</span><span class="s3">(</span><span class="s8">originalJob</span><span class="s3">.</span><span class="s1">products</span><span class="s3">) </span><span class="s9">!==</span><span class="s3"> </span><span class="s1">JSON</span><span class="s3">.</span><span class="s10">stringify</span><span class="s3">(</span><span class="s8">job</span><span class="s3">.</span><span class="s1">products</span><span class="s3">)</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s9">!</span><span class="s1">shouldBreakFromGroup</span><span class="s3">) {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s2">await</span><span class="s1"> </span><span class="s10">updateDoc</span><span class="s1">(</span><span class="s10">doc</span><span class="s1">(</span><span class="s8">db</span><span class="s1">, </span><span class="s4">'jobsByField'</span><span class="s1">, </span><span class="s8">job</span><span class="s1">.</span><span class="s5">id</span><span class="s1">), {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s9">...</span><span class="s8">job</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">navigate</span><span class="s3">(</span><span class="s4">'/jobs'</span><span class="s3">);</span></p>
<p class="p9"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">return</span><span class="s3">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">// ğŸ” (Then paste the breakaway logic here)</span></p>
<p class="p6"><span class="s1">};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s2">try</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â Â  Â  </span></span><span class="s2">await</span><span class="s1"> </span><span class="s10">updateDoc</span><span class="s1">(</span><span class="s10">doc</span><span class="s1">(</span><span class="s5">db</span><span class="s1">, </span><span class="s4">'jobsByField'</span><span class="s1">, </span><span class="s5">job</span><span class="s1">.</span><span class="s5">id</span><span class="s1">), {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">products:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">products</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">status:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">status</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">'Planned'</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">vendor:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">vendor</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">''</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">applicator:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">applicator</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">''</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">jobDate:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">jobDate</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">''</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">linkedToJobId:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">linkedToJobId</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s7">null</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">notes:</span><span class="s3"> </span><span class="s1">notes</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s4">''</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">passes:</span><span class="s3"> </span><span class="s1">job</span><span class="s3">?.</span><span class="s1">jobType</span><span class="s3">?.</span><span class="s1">parentName</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Tillage'</span><span class="s3"> </span><span class="s9">?</span><span class="s3"> </span><span class="s1">passes</span><span class="s3"> </span><span class="s9">:</span><span class="s3"> </span><span class="s7">undefined</span><span class="s3">,</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1">});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s10">navigate</span><span class="s1">(</span><span class="s4">'/jobs'</span><span class="s1">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>} </span><span class="s2">catch</span><span class="s1"> (</span><span class="s5">err</span><span class="s1">) {</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">console</span><span class="s3">.</span><span class="s10">error</span><span class="s3">(</span><span class="s1">'Error updating field job:'</span><span class="s3">, </span><span class="s5">err</span><span class="s3">);</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s10">alert</span><span class="s3">(</span><span class="s1">'Failed to save changes.'</span><span class="s3">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>} </span><span class="s2">finally</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s10">setSaving</span><span class="s1">(</span><span class="s7">false</span><span class="s1">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">function</span><span class="s3"> </span><span class="s10">renderBoundarySVG</span><span class="s3">(</span><span class="s1">baseGeometry</span><span class="s3">, </span><span class="s1">overlayGeoJSON</span><span class="s3">) {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s9">!</span><span class="s1">baseGeometry</span><span class="s3">) </span><span class="s2">return</span><span class="s3"> </span><span class="s7">null</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">let</span><span class="s3"> </span><span class="s1">base</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">baseGeometry</span><span class="s3">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s1">base</span><span class="s3">.</span><span class="s1">type</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Feature'</span><span class="s3">) </span><span class="s1">base</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">base</span><span class="s3">.</span><span class="s1">geometry</span><span class="s3">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s1">base</span><span class="s3">.</span><span class="s1">type</span><span class="s3"> </span><span class="s9">!==</span><span class="s3"> </span><span class="s4">'Polygon'</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s9">!</span><span class="s1">base</span><span class="s3">.</span><span class="s1">coordinates</span><span class="s3">?.[</span><span class="s11">0</span><span class="s3">]) </span><span class="s2">return</span><span class="s3"> </span><span class="s7">null</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">baseCoords</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">base</span><span class="s3">.</span><span class="s1">coordinates</span><span class="s3">[</span><span class="s11">0</span><span class="s3">];</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">bounds</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s5">baseCoords</span><span class="s1">.</span><span class="s10">reduce</span><span class="s1">((</span><span class="s5">acc</span><span class="s1">, [</span><span class="s5">lng</span><span class="s1">, </span><span class="s5">lat</span><span class="s1">]) </span><span class="s7">=&gt;</span><span class="s1"> ({</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">minX:</span><span class="s3"> </span><span class="s1">Math</span><span class="s3">.</span><span class="s10">min</span><span class="s3">(</span><span class="s1">acc</span><span class="s3">.</span><span class="s1">minX</span><span class="s3">, </span><span class="s1">lng</span><span class="s3">),</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">maxX:</span><span class="s3"> </span><span class="s1">Math</span><span class="s3">.</span><span class="s10">max</span><span class="s3">(</span><span class="s1">acc</span><span class="s3">.</span><span class="s1">maxX</span><span class="s3">, </span><span class="s1">lng</span><span class="s3">),</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">minY:</span><span class="s3"> </span><span class="s1">Math</span><span class="s3">.</span><span class="s10">min</span><span class="s3">(</span><span class="s1">acc</span><span class="s3">.</span><span class="s1">minY</span><span class="s3">, </span><span class="s1">lat</span><span class="s3">),</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">maxY:</span><span class="s3"> </span><span class="s1">Math</span><span class="s3">.</span><span class="s10">max</span><span class="s3">(</span><span class="s1">acc</span><span class="s3">.</span><span class="s1">maxY</span><span class="s3">, </span><span class="s1">lat</span><span class="s3">),</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span>}), { </span><span class="s5">minX:</span><span class="s3"> </span><span class="s1">Infinity</span><span class="s3">, </span><span class="s5">maxX:</span><span class="s3"> </span><span class="s9">-</span><span class="s1">Infinity</span><span class="s3">, </span><span class="s5">minY:</span><span class="s3"> </span><span class="s1">Infinity</span><span class="s3">, </span><span class="s5">maxY:</span><span class="s3"> </span><span class="s9">-</span><span class="s1">Infinity</span><span class="s3"> });</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">width</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">bounds</span><span class="s3">.</span><span class="s1">maxX</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> </span><span class="s1">bounds</span><span class="s3">.</span><span class="s1">minX</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s11">1</span><span class="s3">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">height</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">bounds</span><span class="s3">.</span><span class="s1">maxY</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> </span><span class="s1">bounds</span><span class="s3">.</span><span class="s1">minY</span><span class="s3"> </span><span class="s9">||</span><span class="s3"> </span><span class="s11">1</span><span class="s3">;</span></p>
<p class="p7"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">boxSize</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s11">300</span><span class="s3">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">margin</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> </span><span class="s11">10</span><span class="s1">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">scale</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span><span class="s1">boxSize</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> </span><span class="s1">margin</span><span class="s3"> </span><span class="s9">*</span><span class="s3"> </span><span class="s11">2</span><span class="s3">) </span><span class="s9">/</span><span class="s3"> </span><span class="s1">Math</span><span class="s3">.</span><span class="s10">max</span><span class="s3">(</span><span class="s1">width</span><span class="s3">, </span><span class="s1">height</span><span class="s3">);</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">xOffset</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span><span class="s1">boxSize</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> </span><span class="s1">width</span><span class="s3"> </span><span class="s9">*</span><span class="s3"> </span><span class="s1">scale</span><span class="s3">) </span><span class="s9">/</span><span class="s3"> </span><span class="s11">2</span><span class="s3">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">yOffset</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span><span class="s1">boxSize</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> </span><span class="s1">height</span><span class="s3"> </span><span class="s9">*</span><span class="s3"> </span><span class="s1">scale</span><span class="s3">) </span><span class="s9">/</span><span class="s3"> </span><span class="s11">2</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s10">project</span><span class="s1"> </span><span class="s9">=</span><span class="s1"> ([</span><span class="s5">lng</span><span class="s1">, </span><span class="s5">lat</span><span class="s1">]) </span><span class="s7">=&gt;</span><span class="s1"> ({</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">x:</span><span class="s3"> (</span><span class="s1">lng</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> </span><span class="s1">bounds</span><span class="s3">.</span><span class="s1">minX</span><span class="s3">) </span><span class="s9">*</span><span class="s3"> </span><span class="s1">scale</span><span class="s3"> </span><span class="s9">+</span><span class="s3"> </span><span class="s1">xOffset</span><span class="s3">,</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">y:</span><span class="s3"> </span><span class="s1">boxSize</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> ((</span><span class="s1">lat</span><span class="s3"> </span><span class="s9">-</span><span class="s3"> </span><span class="s1">bounds</span><span class="s3">.</span><span class="s1">minY</span><span class="s3">) </span><span class="s9">*</span><span class="s3"> </span><span class="s1">scale</span><span class="s3"> </span><span class="s9">+</span><span class="s3"> </span><span class="s1">yOffset</span><span class="s3">),</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>});</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s1">pathFromCoords</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> (</span><span class="s5">coords</span><span class="s3">) </span><span class="s7">=&gt;</span><span class="s3"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s2">return</span><span class="s1"> </span><span class="s5">coords</span><span class="s1">.</span><span class="s10">map</span><span class="s1">((</span><span class="s5">pt</span><span class="s1">, </span><span class="s5">i</span><span class="s1">) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> { </span><span class="s8">x</span><span class="s1">, </span><span class="s8">y</span><span class="s1"> } </span><span class="s9">=</span><span class="s1"> </span><span class="s10">project</span><span class="s1">(</span><span class="s5">pt</span><span class="s1">);</span></p>
<p class="p10"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s2">return</span><span class="s3"> </span><span class="s4">`</span><span class="s7">${</span><span class="s5">i</span><span class="s1"> === </span><span class="s11">0</span><span class="s1"> ? </span><span class="s4">'M'</span><span class="s1"> : </span><span class="s4">'L'</span><span class="s7">}${</span><span class="s5">x</span><span class="s7">}</span><span class="s4">,</span><span class="s7">${</span><span class="s5">y</span><span class="s7">}</span><span class="s4">`</span><span class="s3">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}).</span><span class="s10">join</span><span class="s1">(</span><span class="s4">' '</span><span class="s1">) </span><span class="s9">+</span><span class="s1"> </span><span class="s4">' Z'</span><span class="s1">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>};</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s3"> </span><span class="s8">basePath</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">pathFromCoords</span><span class="s3">(</span><span class="s5">baseCoords</span><span class="s3">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">let</span><span class="s3"> </span><span class="s1">overlayPaths</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> [];</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s3"> (</span><span class="s5">overlayGeoJSON</span><span class="s3">?.</span><span class="s5">type</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s1">'FeatureCollection'</span><span class="s3">) {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">overlayPaths</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">overlayGeoJSON</span><span class="s3">.</span><span class="s1">features</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>.</span><span class="s10">filter</span><span class="s1">(</span><span class="s5">f</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s5">f</span><span class="s1">.</span><span class="s5">geometry</span><span class="s1">?.</span><span class="s5">type</span><span class="s1"> </span><span class="s9">===</span><span class="s1"> </span><span class="s4">'Polygon'</span><span class="s1">)</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span>.</span><span class="s10">map</span><span class="s3">(</span><span class="s1">f</span><span class="s3"> </span><span class="s7">=&gt;</span><span class="s3"> </span><span class="s10">pathFromCoords</span><span class="s3">(</span><span class="s1">f</span><span class="s3">.</span><span class="s1">geometry</span><span class="s3">.</span><span class="s1">coordinates</span><span class="s3">[</span><span class="s11">0</span><span class="s3">]));</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span>} </span><span class="s2">else</span><span class="s3"> </span><span class="s2">if</span><span class="s3"> (</span><span class="s1">overlayGeoJSON</span><span class="s3">?.</span><span class="s1">type</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Feature'</span><span class="s3"> </span><span class="s9">&amp;&amp;</span><span class="s3"> </span><span class="s1">overlayGeoJSON</span><span class="s3">.</span><span class="s1">geometry</span><span class="s3">?.</span><span class="s1">type</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Polygon'</span><span class="s3">) {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">overlayPaths</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> [</span><span class="s10">pathFromCoords</span><span class="s3">(</span><span class="s1">overlayGeoJSON</span><span class="s3">.</span><span class="s1">geometry</span><span class="s3">.</span><span class="s1">coordinates</span><span class="s3">[</span><span class="s11">0</span><span class="s3">])];</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span>} </span><span class="s2">else</span><span class="s3"> </span><span class="s2">if</span><span class="s3"> (</span><span class="s1">overlayGeoJSON</span><span class="s3">?.</span><span class="s1">type</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Polygon'</span><span class="s3">) {</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">overlayPaths</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> [</span><span class="s10">pathFromCoords</span><span class="s3">(</span><span class="s1">overlayGeoJSON</span><span class="s3">.</span><span class="s1">coordinates</span><span class="s3">[</span><span class="s11">0</span><span class="s3">])];</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p9"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">return</span><span class="s3"> (</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">svg</span><span class="s3"> </span><span class="s5">viewBox</span><span class="s9">=</span><span class="s7">{</span><span class="s1">`0 0 </span><span class="s7">${</span><span class="s5">boxSize</span><span class="s7">}</span><span class="s1"> </span><span class="s7">${</span><span class="s5">boxSize</span><span class="s7">}</span><span class="s1">`</span><span class="s7">}</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"w-64 h-64 bg-white border rounded shadow mx-auto"</span><span class="s13">&gt;</span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">/* Base field = red if overlay exists */</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">path</span><span class="s3"> </span><span class="s1">d</span><span class="s9">=</span><span class="s7">{</span><span class="s1">basePath</span><span class="s7">}</span><span class="s3"> </span><span class="s1">fill</span><span class="s9">=</span><span class="s7">{</span><span class="s1">overlayPaths</span><span class="s9">.</span><span class="s1">length</span><span class="s9"> ? </span><span class="s4">'#F87171'</span><span class="s9"> : </span><span class="s4">'#34D399'</span><span class="s7">}</span><span class="s3"> </span><span class="s1">fillOpacity</span><span class="s9">=</span><span class="s7">{</span><span class="s11">0.4</span><span class="s7">}</span><span class="s3"> </span><span class="s1">stroke</span><span class="s9">=</span><span class="s4">"#4B5563"</span><span class="s3"> </span><span class="s1">strokeWidth</span><span class="s9">=</span><span class="s4">"1.5"</span><span class="s3"> </span><span class="s13">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â </span></span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">/* Overlay polygons = green */</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">overlayPaths</span><span class="s9">.</span><span class="s10">map</span><span class="s9">((</span><span class="s1">d</span><span class="s9">, </span><span class="s1">i</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> (</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">path</span><span class="s9"> </span><span class="s1">key</span><span class="s9">=</span><span class="s7">{</span><span class="s1">i</span><span class="s7">}</span><span class="s9"> </span><span class="s1">d</span><span class="s9">=</span><span class="s7">{</span><span class="s1">d</span><span class="s7">}</span><span class="s9"> </span><span class="s1">fill</span><span class="s9">=</span><span class="s4">"#34D399"</span><span class="s9"> </span><span class="s1">fillOpacity</span><span class="s9">=</span><span class="s7">{</span><span class="s11">0.6</span><span class="s7">}</span><span class="s9"> </span><span class="s1">stroke</span><span class="s9">=</span><span class="s4">"#047857"</span><span class="s9"> </span><span class="s1">strokeWidth</span><span class="s9">=</span><span class="s4">"2"</span><span class="s9"> </span><span class="s13">/&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>))</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;/</span><span class="s7">svg</span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>);</span></p>
<p class="p6"><span class="s1">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s1"> (</span><span class="s9">!</span><span class="s5">job</span><span class="s1">) </span><span class="s2">return</span><span class="s1"> </span><span class="s13">&lt;</span><span class="s7">div</span><span class="s1"> </span><span class="s5">className</span><span class="s9">=</span><span class="s4">"p-6"</span><span class="s13">&gt;</span><span class="s1">Loading...</span><span class="s13">&lt;/</span><span class="s7">div</span><span class="s13">&gt;</span><span class="s1">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s7">const</span><span class="s3"> </span><span class="s8">requiresProducts</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> [</span><span class="s1">'Seeding'</span><span class="s3">, </span><span class="s1">'Spraying'</span><span class="s3">, </span><span class="s1">'Fertilizing'</span><span class="s3">].</span><span class="s10">includes</span><span class="s3">(</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">job</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3">?.</span><span class="s1">parentName</span></p>
<p class="p6"><span class="s1">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s7">const</span><span class="s3"> </span><span class="s8">requiresWater</span><span class="s3"> </span><span class="s9">=</span><span class="s3"> </span><span class="s1">job</span><span class="s3">.</span><span class="s1">jobType</span><span class="s3">?.</span><span class="s1">parentName</span><span class="s3"> </span><span class="s9">===</span><span class="s3"> </span><span class="s4">'Spraying'</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p9"><span class="s3"><span class="Apple-converted-space">Â </span></span><span class="s1">return</span><span class="s3"> (</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"px-4 py-6 max-w-full overflow-x-hidden"</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">h2</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"text-xl font-bold mb-4"</span><span class="s13">&gt;</span><span class="s3">Edit Field Job â€“ </span><span class="s7">{</span><span class="s5">job</span><span class="s9">.</span><span class="s5">fieldName</span><span class="s7">}</span><span class="s13">&lt;/</span><span class="s7">h2</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"mb-4"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium"</span><span class="s13">&gt;</span><span class="s3">Job Type</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s13">&lt;</span><span class="s1">select</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">job</span><span class="s9">.</span><span class="s1">jobType</span><span class="s9">?.</span><span class="s1">name</span><span class="s9"> || </span><span class="s4">''</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s9">(</span><span class="s1">e</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">selected</span><span class="s9"> = </span><span class="s1">jobTypesList</span><span class="s9">.</span><span class="s10">find</span><span class="s9">(</span><span class="s1">t</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s1">t</span><span class="s9">.</span><span class="s1">name</span><span class="s9"> === </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9">);</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s10">setJob</span><span class="s9">(</span><span class="s1">prev</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> ({ ...</span><span class="s1">prev</span><span class="s9">, </span><span class="s1">jobType:</span><span class="s9"> </span><span class="s1">selected</span><span class="s9"> }));</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span><span class="s7">}</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border border-gray-300 rounded-md px-3 py-2 bg-white w-full focus:outline-none focus:ring-2 focus:ring-blue-500"</span></p>
<p class="p11"><span class="s1">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s1"> </span><span class="s5">value</span><span class="s9">=</span><span class="s4">""</span><span class="s13">&gt;</span><span class="s1">Select Job Type</span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s1">jobTypesList</span><span class="s9">.</span><span class="s10">map</span><span class="s9">(</span><span class="s1">type</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> (</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s9"> </span><span class="s1">key</span><span class="s9">=</span><span class="s7">{</span><span class="s1">type</span><span class="s9">.</span><span class="s1">name</span><span class="s7">}</span><span class="s9"> </span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">type</span><span class="s9">.</span><span class="s1">name</span><span class="s7">}</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">type</span><span class="s9">.</span><span class="s1">name</span><span class="s7">}</span><span class="s9"> </span><span class="s7">{</span><span class="s1">type</span><span class="s9">.</span><span class="s1">parentName</span><span class="s9"> ? </span><span class="s4">`(</span><span class="s7">${</span><span class="s1">type</span><span class="s9">.</span><span class="s1">parentName</span><span class="s7">}</span><span class="s4">)`</span><span class="s9"> : </span><span class="s4">''</span><span class="s7">}</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;/</span><span class="s1">option</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>))</span><span class="s7">}</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">select</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"mb-4 flex gap-4"</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium text-gray-700"</span><span class="s13">&gt;</span><span class="s3">Vendor</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">select</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border p-2 rounded"</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">job</span><span class="s9">.</span><span class="s1">vendor</span><span class="s9"> || </span><span class="s4">''</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s1">e</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setJob</span><span class="s9">(</span><span class="s1">prev</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> ({ ...</span><span class="s1">prev</span><span class="s9">, </span><span class="s1">vendor:</span><span class="s9"> </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9"> }))</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s1"> </span><span class="s5">value</span><span class="s9">=</span><span class="s4">""</span><span class="s13">&gt;</span><span class="s1">Select Vendor</span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">vendors</span><span class="s9">.</span><span class="s10">map</span><span class="s9">(</span><span class="s1">v</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> (</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">option</span><span class="s9"> </span><span class="s5">key</span><span class="s9">=</span><span class="s1">{</span><span class="s5">v</span><span class="s1">}</span><span class="s9"> </span><span class="s5">value</span><span class="s9">=</span><span class="s1">{</span><span class="s5">v</span><span class="s1">}</span><span class="s13">&gt;</span><span class="s1">{</span><span class="s5">v</span><span class="s1">}</span><span class="s13">&lt;/</span><span class="s1">option</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>))</span><span class="s7">}</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;/</span><span class="s1">select</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"mb-4 flex gap-4"</span><span class="s13">&gt;</span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s1">/* Vendor dropdown */</span><span class="s7">}</span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s1">/* Applicator dropdown */</span><span class="s7">}</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"mb-4"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium text-gray-700"</span><span class="s13">&gt;</span><span class="s3">Job Date</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">input</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">type</span><span class="s9">=</span><span class="s1">"date"</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border p-2 rounded"</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">job</span><span class="s9">.</span><span class="s1">jobDate</span><span class="s9"> || </span><span class="s4">''</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s1">e</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setJob</span><span class="s9">(</span><span class="s1">prev</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> ({ ...</span><span class="s1">prev</span><span class="s9">, </span><span class="s1">jobDate:</span><span class="s9"> </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9"> }))</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">/&gt;</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"mb-4"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium text-gray-700"</span><span class="s13">&gt;</span><span class="s3">Job Status</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">select</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border p-2 rounded"</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">job</span><span class="s9">.</span><span class="s1">status</span><span class="s9"> || </span><span class="s4">'Planned'</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s1">e</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setJob</span><span class="s9">(</span><span class="s1">prev</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> ({ ...</span><span class="s1">prev</span><span class="s9">, </span><span class="s1">status:</span><span class="s9"> </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9"> }))</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s1"> </span><span class="s5">value</span><span class="s9">=</span><span class="s4">"Planned"</span><span class="s13">&gt;</span><span class="s1">Planned</span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s1"> </span><span class="s5">value</span><span class="s9">=</span><span class="s4">"Completed"</span><span class="s13">&gt;</span><span class="s1">Completed</span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">select</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium text-gray-700"</span><span class="s13">&gt;</span><span class="s3">Applicator</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">select</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border p-2 rounded"</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">job</span><span class="s9">.</span><span class="s1">applicator</span><span class="s9"> || </span><span class="s4">''</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s1">e</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setJob</span><span class="s9">(</span><span class="s1">prev</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> ({ ...</span><span class="s1">prev</span><span class="s9">, </span><span class="s1">applicator:</span><span class="s9"> </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9"> }))</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s1"> </span><span class="s5">value</span><span class="s9">=</span><span class="s4">""</span><span class="s13">&gt;</span><span class="s1">Select Applicator</span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">applicators</span><span class="s9">.</span><span class="s10">map</span><span class="s9">(</span><span class="s1">a</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> (</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">option</span><span class="s9"> </span><span class="s5">key</span><span class="s9">=</span><span class="s1">{</span><span class="s5">a</span><span class="s1">}</span><span class="s9"> </span><span class="s5">value</span><span class="s9">=</span><span class="s1">{</span><span class="s5">a</span><span class="s1">}</span><span class="s13">&gt;</span><span class="s1">{</span><span class="s5">a</span><span class="s1">}</span><span class="s13">&lt;/</span><span class="s1">option</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>))</span><span class="s7">}</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;/</span><span class="s1">select</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">p</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"mb-2 text-sm text-gray-500"</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s10">getJobTypeName</span><span class="s9">(</span><span class="s1">job</span><span class="s9">)</span><span class="s7">}</span><span class="s3"> â€¢ </span><span class="s7">{</span><span class="s1">job</span><span class="s9">.</span><span class="s1">cropYear</span><span class="s7">}</span><span class="s3"> â€¢ </span><span class="s7">{</span><span class="s9">(</span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnAcres</span><span class="s9"> ?? </span><span class="s1">job</span><span class="s9">.</span><span class="s1">acres</span><span class="s9">)?.</span><span class="s10">toFixed</span><span class="s9">(</span><span class="s11">2</span><span class="s9">)</span><span class="s7">}</span><span class="s3"> acres</span></p>
<p class="p11"><span class="s1">&lt;/</span><span class="s7">p</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"mb-6"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"grid grid-cols-3 font-semibold border-b pb-1 mb-1"</span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">span</span><span class="s13">&gt;</span><span class="s1">Product</span><span class="s13">&lt;/</span><span class="s7">span</span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">span</span><span class="s13">&gt;</span><span class="s1">Rate</span><span class="s13">&lt;/</span><span class="s7">span</span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">span</span><span class="s13">&gt;</span><span class="s1">Units</span><span class="s13">&lt;/</span><span class="s7">span</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">job</span><span class="s9">.</span><span class="s1">products</span><span class="s9">.</span><span class="s10">map</span><span class="s9">((</span><span class="s1">p</span><span class="s9">, </span><span class="s1">i</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> (</span></p>
<p class="p8"><span class="s13">&lt;</span><span class="s1">div</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">key</span><span class="s9">=</span><span class="s7">{</span><span class="s1">i</span><span class="s7">}</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"grid grid-cols-1 sm:grid-cols-3 gap-2 mb-2"</span></p>
<p class="p11"><span class="s1">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">select</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border p-2 rounded"</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">p</span><span class="s9">.</span><span class="s1">productName</span><span class="s9"> || </span><span class="s4">''</span><span class="s7">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s9">(</span><span class="s1">e</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">productName</span><span class="s9"> = </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9">;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">matched</span><span class="s9"> = </span><span class="s1">productsList</span><span class="s9">.</span><span class="s10">find</span><span class="s9">(</span><span class="s1">prod</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s1">prod</span><span class="s9">.</span><span class="s1">name</span><span class="s9"> === </span><span class="s1">productName</span><span class="s9">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">handleProductChange</span><span class="s9">(</span><span class="s5">i</span><span class="s9">, </span><span class="s4">'productName'</span><span class="s9">, </span><span class="s5">productName</span><span class="s9">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s9"> (</span><span class="s1">matched</span><span class="s9">) {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">rateType</span><span class="s9"> = </span><span class="s1">matched</span><span class="s9">?.</span><span class="s1">rateType</span><span class="s9">?.</span><span class="s10">toLowerCase</span><span class="s9">();</span></p>
<p class="p7"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s1">cleanUnit</span><span class="s9"> =</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">rateType</span><span class="s1"> === </span><span class="s4">'weight'</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>? </span><span class="s4">'lbs/acre'</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>: </span><span class="s5">rateType</span><span class="s1"> === </span><span class="s4">'population'</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span>? </span><span class="s1">'seeds/acre'</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>: </span><span class="s5">matched</span><span class="s1">.</span><span class="s5">unit</span><span class="s1"> || </span><span class="s4">''</span><span class="s1">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">handleProductChange</span><span class="s9">(</span><span class="s5">i</span><span class="s9">, </span><span class="s4">'unit'</span><span class="s9">, </span><span class="s5">cleanUnit</span><span class="s9">);</span></p>
<p class="p5"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">handleProductChange</span><span class="s9">(</span><span class="s5">i</span><span class="s9">, </span><span class="s4">'rateType'</span><span class="s9">, </span><span class="s5">matched</span><span class="s9">.</span><span class="s5">rateType</span><span class="s9"> || </span><span class="s4">''</span><span class="s9">);</span></p>
<p class="p5"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">handleProductChange</span><span class="s9">(</span><span class="s5">i</span><span class="s9">, </span><span class="s4">'productId'</span><span class="s9">, </span><span class="s5">matched</span><span class="s9">.</span><span class="s5">id</span><span class="s9">);</span></p>
<p class="p5"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">handleProductChange</span><span class="s9">(</span><span class="s5">i</span><span class="s9">, </span><span class="s4">'crop'</span><span class="s9">, </span><span class="s5">matched</span><span class="s9">.</span><span class="s5">crop</span><span class="s9"> || </span><span class="s4">''</span><span class="s9">);</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p10"><span class="s1">}</span><span class="s7">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p11"><span class="s1">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s1"> </span><span class="s5">value</span><span class="s1">=</span><span class="s4">""</span><span class="s13">&gt;</span><span class="s1">Select Product</span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s1">productsList</span><span class="s9">.</span><span class="s10">map</span><span class="s9">(</span><span class="s1">prod</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> (</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s9"> </span><span class="s1">key</span><span class="s9">=</span><span class="s7">{</span><span class="s1">prod</span><span class="s9">.</span><span class="s1">id</span><span class="s7">}</span><span class="s9"> </span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">prod</span><span class="s9">.</span><span class="s1">name</span><span class="s7">}</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">{</span><span class="s1">prod</span><span class="s9">.</span><span class="s1">name</span><span class="s7">}</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">option</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1">))</span><span class="s7">}</span></p>
<p class="p1"><span class="s13">&lt;/</span><span class="s7">select</span><span class="s13">&gt;</span><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s1">/* ğŸ‘ˆ properly close the dropdown here */</span><span class="s7">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">input</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s5">type</span><span class="s9">=</span><span class="s1">"text"</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border p-1 rounded"</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">p</span><span class="s9">.</span><span class="s1">rate</span><span class="s7">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s1">e</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">handleProductChange</span><span class="s9">(</span><span class="s1">i</span><span class="s9">, </span><span class="s4">'rate'</span><span class="s9">, </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9">)</span><span class="s7">}</span></p>
<p class="p11"><span class="s1">/&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s7">{</span><span class="s1">(() </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">rateType</span><span class="s1"> = </span><span class="s5">p</span><span class="s1">.</span><span class="s5">rateType</span><span class="s1">?.</span><span class="s10">toLowerCase</span><span class="s1">() || </span><span class="s4">''</span><span class="s1">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â </span></span><span class="s7">let</span><span class="s9"> </span><span class="s1">unitOptions</span><span class="s9"> = [</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">"oz/acre"</span><span class="s9">,</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">"pt/acre"</span><span class="s9">,</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">"qt/acre"</span><span class="s9">,</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">"gal/acre"</span><span class="s9">,</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">"lbs/acre"</span><span class="s9">,</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">"seeds/acre"</span><span class="s9">,</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">"%v/v"</span></p>
<p class="p10"><span class="s1">];</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s1"> (</span><span class="s5">rateType</span><span class="s1"> === </span><span class="s4">'weight'</span><span class="s1">) {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">unitOptions</span><span class="s9"> = [</span><span class="s4">'lbs/acre'</span><span class="s9">];</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>} </span><span class="s2">else</span><span class="s1"> </span><span class="s2">if</span><span class="s1"> (</span><span class="s5">rateType</span><span class="s1"> === </span><span class="s4">'population'</span><span class="s1">) {</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">unitOptions</span><span class="s9"> = [</span><span class="s1">'seeds/acre'</span><span class="s9">];</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p9"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">return</span><span class="s9"> (</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">select</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border p-2 rounded"</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">p</span><span class="s9">.</span><span class="s1">unit</span><span class="s7">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s9">(</span><span class="s1">e</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">handleProductChange</span><span class="s9">(</span><span class="s1">i</span><span class="s9">, </span><span class="s4">'unit'</span><span class="s9">, </span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9">)</span><span class="s7">}</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s1"> </span><span class="s5">value</span><span class="s1">=</span><span class="s4">""</span><span class="s13">&gt;</span><span class="s1">Select Unit</span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">unitOptions</span><span class="s9">.</span><span class="s10">map</span><span class="s9">(</span><span class="s1">unit</span><span class="s9"> </span><span class="s7">=&gt;</span><span class="s9"> (</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">option</span><span class="s9"> </span><span class="s1">key</span><span class="s9">=</span><span class="s7">{</span><span class="s1">unit</span><span class="s7">}</span><span class="s9"> </span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">unit</span><span class="s7">}</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s7">{</span><span class="s5">unit</span><span class="s7">}</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s13">&lt;/</span><span class="s7">option</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>))</span><span class="s7">}</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;/</span><span class="s1">select</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>);</span></p>
<p class="p10"><span class="s1">})()</span><span class="s7">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s13">&lt;/</span><span class="s7">div</span><span class="s13">&gt;</span></p>
<p class="p12"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â </span></span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>))</span><span class="s7">}</span></p>
<p class="p2"><span class="s7">{</span><span class="s1">requiresProducts</span><span class="s9"> &amp;&amp; (</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;&gt;</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">button</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">onClick</span><span class="s1">=</span><span class="s7">{</span><span class="s1">() </span><span class="s7">=&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s10">setJob</span><span class="s1">(</span><span class="s5">prev</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> ({</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>...</span><span class="s5">prev</span><span class="s1">,</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s1">products:</span><span class="s9"> [...</span><span class="s1">prev</span><span class="s9">.</span><span class="s1">products</span><span class="s9">, { </span><span class="s1">productId:</span><span class="s9"> </span><span class="s4">''</span><span class="s9">, </span><span class="s1">productName:</span><span class="s9"> </span><span class="s4">''</span><span class="s9">, </span><span class="s1">rate:</span><span class="s9"> </span><span class="s4">''</span><span class="s9">, </span><span class="s1">unit:</span><span class="s9"> </span><span class="s4">''</span><span class="s9"> }]</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}))</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">}</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"text-sm bg-blue-600 text-white px-3 py-1 rounded shadow hover:bg-blue-700 transition mb-4"</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>+ Add Product</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;/</span><span class="s1">button</span><span class="s13">&gt;</span></p>
<p class="p11"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s1">&lt;/&gt;</span></p>
<p class="p10"><span class="s1">)</span><span class="s7">}</span></p>
<p class="p2"><span class="s7">{</span><span class="s1">job</span><span class="s9">?.</span><span class="s1">jobType</span><span class="s9">?.</span><span class="s1">parentName</span><span class="s9"> === </span><span class="s4">'Tillage'</span><span class="s9"> &amp;&amp; (</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span><span class="s9"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"mb-4"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium"</span><span class="s13">&gt;</span><span class="s9">Number of Passes</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">input</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">type</span><span class="s9">=</span><span class="s1">"number"</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">min</span><span class="s1">=</span><span class="s7">{</span><span class="s11">1</span><span class="s7">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">passes</span><span class="s7">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s9">(</span><span class="s1">e</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setPasses</span><span class="s9">(</span><span class="s10">parseInt</span><span class="s9">(</span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9">) || </span><span class="s11">1</span><span class="s9">)</span><span class="s7">}</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border border-gray-300 rounded-md px-3 py-2 w-32 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500"</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">/&gt;</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1">)</span><span class="s7">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s7">{</span><span class="s1">requiresWater</span><span class="s9"> &amp;&amp; (</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span><span class="s9"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"mb-4"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium text-gray-700"</span><span class="s13">&gt;</span><span class="s9">Water Volume (gal/acre)</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s1">input</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">type</span><span class="s9">=</span><span class="s1">"number"</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border rounded p-2 w-48"</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">waterVolume</span><span class="s7">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s9">(</span><span class="s1">e</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setWaterVolume</span><span class="s9">(</span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9">)</span><span class="s7">}</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">/&gt;</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1">)</span><span class="s7">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"border border-gray-300 rounded-xl bg-white p-4 shadow-sm mb-6"</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s1">field</span><span class="s9"> &amp;&amp; (</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;&gt;</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">p</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"text-sm text-gray-800 mb-1"</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">strong</span><span class="s13">&gt;</span><span class="s1">{</span><span class="s5">job</span><span class="s9">.</span><span class="s5">fieldName</span><span class="s1">}</span><span class="s13">&lt;/</span><span class="s1">strong</span><span class="s13">&gt;</span><span class="s9"> â€“</span><span class="s1">{</span><span class="s4">' '</span><span class="s1">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s7">{</span><span class="s1">isLeveeJob</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span>? </span><span class="s4">`</span><span class="s7">${</span><span class="s9">((</span><span class="s1">job</span><span class="s9">.</span><span class="s1">crop</span><span class="s9"> || </span><span class="s4">''</span><span class="s9">).</span><span class="s10">includes</span><span class="s9">(</span><span class="s4">'Rice'</span><span class="s9">) ? </span><span class="s1">field</span><span class="s9">?.</span><span class="s1">riceLeveeAcres</span><span class="s9"> : </span><span class="s1">field</span><span class="s9">?.</span><span class="s1">beanLeveeAcres</span><span class="s9">) || </span><span class="s11">0</span><span class="s7">}</span><span class="s4"> acres (Levee â€“ </span><span class="s7">${</span><span class="s1">job</span><span class="s9">.</span><span class="s1">crop</span><span class="s9"> || </span><span class="s4">'â€”'</span><span class="s7">}</span><span class="s4">)`</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span>: </span><span class="s4">`</span><span class="s7">${</span><span class="s9">(</span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnAcres</span><span class="s9"> ?? </span><span class="s1">job</span><span class="s9">.</span><span class="s1">acres</span><span class="s9">)?.</span><span class="s10">toFixed</span><span class="s9">?.(</span><span class="s11">2</span><span class="s9">)</span><span class="s7">}</span><span class="s4"> acres â€“ </span><span class="s7">${</span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnPolygon</span><span class="s9"> ? </span><span class="s4">'partial'</span><span class="s9"> : </span><span class="s4">'full'</span><span class="s7">}</span><span class="s4">`</span><span class="s7">}</span></p>
<p class="p11"><span class="s1">&lt;/</span><span class="s7">p</span><span class="s1">&gt;</span></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">p</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"text-sm text-gray-600 mb-2"</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>Crop: </span><span class="s7">{</span><span class="s5">job</span><span class="s1">.</span><span class="s5">crop</span><span class="s1"> || </span><span class="s4">'â€”'</span><span class="s7">}</span></p>
<p class="p11"><span class="s1">&lt;/</span><span class="s7">p</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">id</span><span class="s9">=</span><span class="s7">{</span><span class="s1">`field-canvas-</span><span class="s7">${</span><span class="s5">field</span><span class="s9">.</span><span class="s5">id</span><span class="s7">}</span><span class="s1">`</span><span class="s7">}</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"bg-white p-2 rounded border shadow-sm"</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">style</span><span class="s9">=</span><span class="s7">{</span><span class="s9">{ </span><span class="s5">width:</span><span class="s9"> </span><span class="s1">'fit-content'</span><span class="s9">, </span><span class="s5">margin:</span><span class="s9"> </span><span class="s1">'0 auto'</span><span class="s9"> }</span><span class="s7">}</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">(() </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s5">console</span><span class="s9">.</span><span class="s10">log</span><span class="s9">(</span><span class="s1">"ğŸ‘ï¸ Field Boundary:"</span><span class="s9">, </span><span class="s5">fieldBoundary</span><span class="s9">);</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s1">console</span><span class="s9">.</span><span class="s10">log</span><span class="s9">(</span><span class="s4">"ğŸ‘ï¸ Drawn Polygon:"</span><span class="s9">, </span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnPolygon</span><span class="s9">);</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p5"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s2">return</span><span class="s9"> </span><span class="s1">renderBoundarySVG</span><span class="s9">(</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span></span><span class="s1">fieldBoundary</span><span class="s9">,</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span></span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnPolygon</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>);</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>})()</span><span class="s7">}</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&lt;/</span><span class="s7">div</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span><span class="s9"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"mt-6"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">label</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"block text-sm font-medium mb-1"</span><span class="s13">&gt;</span><span class="s9">Notes</span><span class="s13">&lt;/</span><span class="s7">label</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">textarea</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">value</span><span class="s9">=</span><span class="s7">{</span><span class="s1">notes</span><span class="s7">}</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s9">(</span><span class="s1">e</span><span class="s9">) </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setNotes</span><span class="s9">(</span><span class="s1">e</span><span class="s9">.</span><span class="s1">target</span><span class="s9">.</span><span class="s1">value</span><span class="s9">)</span><span class="s7">}</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"w-full border border-gray-300 rounded-md p-2 text-sm resize-none"</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">rows</span><span class="s1">=</span><span class="s7">{</span><span class="s11">4</span><span class="s7">}</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">placeholder</span><span class="s9">=</span><span class="s1">"Add any notes for this job..."</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">/&gt;</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;/&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>)</span><span class="s7">}</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"mt-2 no-print"</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">button</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">className</span><span class="s9">=</span><span class="s1">"text-sm text-blue-600 underline"</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">onClick</span><span class="s9">=</span><span class="s7">{</span><span class="s9">() </span><span class="s7">=&gt;</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s10">navigate</span><span class="s9">(</span><span class="s1">`/jobs/edit-area/</span><span class="s7">${</span><span class="s5">job</span><span class="s9">.</span><span class="s5">fieldId</span><span class="s7">}</span><span class="s1">`</span><span class="s9">, {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">state:</span><span class="s1"> {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s5">field:</span><span class="s1"> {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span></span><span class="s5">id:</span><span class="s1"> </span><span class="s5">job</span><span class="s1">.</span><span class="s5">fieldId</span><span class="s1">,</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span></span><span class="s1">fieldName:</span><span class="s9"> </span><span class="s1">job</span><span class="s9">.</span><span class="s1">fieldName</span><span class="s9">,</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span></span><span class="s1">boundary:</span><span class="s9"> </span><span class="s1">fieldBoundary</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>},</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s1">cropYear:</span><span class="s9"> </span><span class="s1">job</span><span class="s9">.</span><span class="s1">cropYear</span><span class="s9">,</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s1">drawnPolygon:</span><span class="s9"> </span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnPolygon</span><span class="s9">,</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s1">drawnAcres:</span><span class="s9"> </span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnAcres</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>})</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>âœï¸ Edit Area</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">button</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â Â  Â  </span></span><span class="s13">&lt;/</span><span class="s7">div</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s7">{</span><span class="s1">requiresProducts</span><span class="s9"> &amp;&amp; (</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"mt-6 border-t pt-4"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">h4</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"font-semibold text-sm mb-2"</span><span class="s13">&gt;</span><span class="s9">Product Totals</span><span class="s13">&lt;/</span><span class="s7">h4</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">{</span><span class="s5">job</span><span class="s1">.</span><span class="s5">products</span><span class="s1">.</span><span class="s10">map</span><span class="s1">((</span><span class="s5">p</span><span class="s1">, </span><span class="s5">i</span><span class="s1">) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">requiresWater</span><span class="s9"> = </span><span class="s1">job</span><span class="s9">.</span><span class="s1">jobType</span><span class="s9">?.</span><span class="s1">parentName</span><span class="s9"> === </span><span class="s4">'Spraying'</span><span class="s9">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">rate</span><span class="s1"> = </span><span class="s10">parseFloat</span><span class="s1">(</span><span class="s5">p</span><span class="s1">.</span><span class="s5">rate</span><span class="s1">);</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">unit</span><span class="s1"> = </span><span class="s5">p</span><span class="s1">.</span><span class="s5">unit</span><span class="s1">?.</span><span class="s10">toLowerCase</span><span class="s1">() || </span><span class="s4">''</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">crop</span><span class="s1"> = </span><span class="s5">p</span><span class="s1">.</span><span class="s5">crop</span><span class="s1">?.</span><span class="s10">toLowerCase</span><span class="s1">?.() || </span><span class="s4">''</span><span class="s1">;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">let</span><span class="s9"> </span><span class="s1">acres</span><span class="s9"> = </span><span class="s1">job</span><span class="s9">.</span><span class="s1">drawnAcres</span><span class="s9"> ?? </span><span class="s1">job</span><span class="s9">.</span><span class="s1">acres</span><span class="s9"> ?? </span><span class="s11">0</span><span class="s9">;</span></p>
<p class="p2"><span class="s2">if</span><span class="s9"> (</span><span class="s1">isLeveeJob</span><span class="s9">) {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s2">if</span><span class="s9"> ((</span><span class="s1">job</span><span class="s9">.</span><span class="s1">crop</span><span class="s9"> || </span><span class="s4">''</span><span class="s9">).</span><span class="s10">includes</span><span class="s9">(</span><span class="s4">'Rice'</span><span class="s9">) &amp;&amp; </span><span class="s1">field</span><span class="s9">?.</span><span class="s1">riceLeveeAcres</span><span class="s9">) {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">acres</span><span class="s9"> = </span><span class="s10">parseFloat</span><span class="s9">(</span><span class="s1">field</span><span class="s9">.</span><span class="s1">riceLeveeAcres</span><span class="s9">);</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  </span>} </span><span class="s2">else</span><span class="s9"> </span><span class="s2">if</span><span class="s9"> ((</span><span class="s1">job</span><span class="s9">.</span><span class="s1">crop</span><span class="s9"> || </span><span class="s4">''</span><span class="s9">).</span><span class="s10">includes</span><span class="s9">(</span><span class="s4">'Soybean'</span><span class="s9">) &amp;&amp; </span><span class="s1">field</span><span class="s9">?.</span><span class="s1">beanLeveeAcres</span><span class="s9">) {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">acres</span><span class="s9"> = </span><span class="s10">parseFloat</span><span class="s9">(</span><span class="s1">field</span><span class="s9">.</span><span class="s1">beanLeveeAcres</span><span class="s9">);</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p10"><span class="s1">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">totalAmount</span><span class="s1"> = </span><span class="s5">rate</span><span class="s1"> * </span><span class="s5">acres</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s7">let</span><span class="s1"> </span><span class="s5">display</span><span class="s1"> = </span><span class="s4">''</span><span class="s1">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s2">if</span><span class="s9"> ([</span><span class="s1">'seeds/acre'</span><span class="s9">, </span><span class="s1">'population'</span><span class="s9">].</span><span class="s10">includes</span><span class="s9">(</span><span class="s5">unit</span><span class="s9">)) {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">seedsPerUnit</span><span class="s1"> = </span><span class="s5">crop</span><span class="s1">.</span><span class="s10">includes</span><span class="s1">(</span><span class="s4">'rice'</span><span class="s1">) ? </span><span class="s11">900000</span><span class="s1"> : </span><span class="s5">crop</span><span class="s1">.</span><span class="s10">includes</span><span class="s1">(</span><span class="s4">'soybean'</span><span class="s1">) ? </span><span class="s11">140000</span><span class="s1"> : </span><span class="s11">1000000</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">totalSeeds</span><span class="s1"> = </span><span class="s5">rate</span><span class="s1"> * </span><span class="s5">acres</span><span class="s1">;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">units</span><span class="s9"> = </span><span class="s1">totalSeeds</span><span class="s9"> / </span><span class="s1">seedsPerUnit</span><span class="s9">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">units</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">1</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> units`</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s1"> </span><span class="s2">if</span><span class="s1"> ([</span><span class="s4">'lbs/acre'</span><span class="s1">].</span><span class="s10">includes</span><span class="s1">(</span><span class="s5">unit</span><span class="s1">)) {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">lbsPerBushel</span><span class="s1"> = </span><span class="s5">crop</span><span class="s1">.</span><span class="s10">includes</span><span class="s1">(</span><span class="s4">'rice'</span><span class="s1">) ? </span><span class="s11">45</span><span class="s1"> : </span><span class="s5">crop</span><span class="s1">.</span><span class="s10">includes</span><span class="s1">(</span><span class="s4">'soybean'</span><span class="s1">) ? </span><span class="s11">60</span><span class="s1"> : </span><span class="s11">50</span><span class="s1">;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">bushels</span><span class="s9"> = </span><span class="s1">totalAmount</span><span class="s9"> / </span><span class="s1">lbsPerBushel</span><span class="s9">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">bushels</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">1</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> bushels`</span><span class="s1">;</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s9"> </span><span class="s2">if</span><span class="s9"> ([</span><span class="s1">'fl oz/acre'</span><span class="s9">, </span><span class="s1">'oz/acre'</span><span class="s9">].</span><span class="s10">includes</span><span class="s9">(</span><span class="s5">unit</span><span class="s9">)) {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">gal</span><span class="s1"> = </span><span class="s5">totalAmount</span><span class="s1"> / </span><span class="s11">128</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">gal</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">2</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> gallons`</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s1"> </span><span class="s2">if</span><span class="s1"> (</span><span class="s5">unit</span><span class="s1"> === </span><span class="s4">'pt/acre'</span><span class="s1">) {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">gal</span><span class="s1"> = </span><span class="s5">totalAmount</span><span class="s1"> / </span><span class="s11">8</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">gal</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">2</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> gallons`</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s1"> </span><span class="s2">if</span><span class="s1"> (</span><span class="s5">unit</span><span class="s1"> === </span><span class="s4">'qt/acre'</span><span class="s1">) {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">gal</span><span class="s1"> = </span><span class="s5">totalAmount</span><span class="s1"> / </span><span class="s11">4</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">gal</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">2</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> gallons`</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s1"> </span><span class="s2">if</span><span class="s1"> (</span><span class="s5">unit</span><span class="s1"> === </span><span class="s4">'oz dry/acre'</span><span class="s1">) {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">lbs</span><span class="s1"> = </span><span class="s5">totalAmount</span><span class="s1"> / </span><span class="s11">16</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">lbs</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">2</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> lbs`</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s1"> </span><span class="s2">if</span><span class="s1"> (</span><span class="s5">unit</span><span class="s1"> === </span><span class="s4">'%v/v'</span><span class="s1">) {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s9"> </span><span class="s8">water</span><span class="s9"> = </span><span class="s10">parseFloat</span><span class="s9">(</span><span class="s1">requiresWater</span><span class="s9"> ? </span><span class="s1">waterVolume</span><span class="s9"> : </span><span class="s11">0</span><span class="s9">);</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">gal</span><span class="s1"> = (</span><span class="s5">rate</span><span class="s1"> / </span><span class="s11">100</span><span class="s1">) * </span><span class="s5">water</span><span class="s1"> * </span><span class="s5">acres</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">gal</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">2</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> gallons`</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s1"> </span><span class="s2">if</span><span class="s1"> (</span><span class="s5">unit</span><span class="s1"> === </span><span class="s4">'tons/acre'</span><span class="s1">) {</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s1">display</span><span class="s9"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s1">totalAmount</span><span class="s9">.</span><span class="s10">toFixed</span><span class="s9">(</span><span class="s11">2</span><span class="s9">)</span><span class="s7">}</span><span class="s4"> tons`</span><span class="s9">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} </span><span class="s2">else</span><span class="s1"> {</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s5">display</span><span class="s1"> = </span><span class="s4">`</span><span class="s7">${</span><span class="s5">totalAmount</span><span class="s1">.</span><span class="s10">toFixed</span><span class="s1">(</span><span class="s11">1</span><span class="s1">)</span><span class="s7">}</span><span class="s4"> </span><span class="s7">${</span><span class="s5">unit</span><span class="s1">.</span><span class="s10">replace</span><span class="s1">(</span><span class="s4">'/acre'</span><span class="s1">, </span><span class="s4">''</span><span class="s1">).</span><span class="s10">trim</span><span class="s1">()</span><span class="s7">}</span><span class="s4">`</span><span class="s1">;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span></span><span class="s2">return</span><span class="s1"> (</span></p>
<p class="p3"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s13">&lt;</span><span class="s7">div</span><span class="s9"> </span><span class="s5">key</span><span class="s9">=</span><span class="s7">{</span><span class="s5">i</span><span class="s7">}</span><span class="s9"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"text-sm text-gray-700"</span><span class="s13">&gt;</span></p>
<p class="p2"><span class="s9"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span></span><span class="s7">{</span><span class="s1">p</span><span class="s9">.</span><span class="s1">productName</span><span class="s9"> || </span><span class="s1">p</span><span class="s9">.</span><span class="s1">name</span><span class="s9"> || </span><span class="s4">'Unnamed'</span><span class="s7">}</span><span class="s9"> â†’ </span><span class="s13">&lt;</span><span class="s7">span</span><span class="s9"> </span><span class="s1">className</span><span class="s9">=</span><span class="s4">"font-mono"</span><span class="s13">&gt;</span><span class="s7">{</span><span class="s1">display</span><span class="s7">}</span><span class="s13">&lt;/</span><span class="s7">span</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span></span><span class="s13">&lt;/</span><span class="s7">div</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>);</span></p>
<p class="p10"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>})</span><span class="s7">}</span></p>
<p class="p8"><span class="s9"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p10"><span class="s1">)</span><span class="s7">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">label</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"flex items-center gap-2 text-sm text-gray-700 mb-2"</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s1">input</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s5">type</span><span class="s9">=</span><span class="s1">"checkbox"</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">checked</span><span class="s9">=</span><span class="s7">{</span><span class="s1">generatePdf</span><span class="s7">}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s1">onChange</span><span class="s9">=</span><span class="s7">{</span><span class="s9">() </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">setGeneratePdf</span><span class="s9">(!</span><span class="s1">generatePdf</span><span class="s9">)</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span></span><span class="s13">/&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">Â  </span>Generate PDF after saving</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">label</span><span class="s13">&gt;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p3"><span class="s13">&lt;</span><span class="s7">div</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"flex justify-between items-center"</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">button</span><span class="s3"> </span><span class="s5">onClick</span><span class="s9">=</span><span class="s7">{</span><span class="s9">() </span><span class="s7">=&gt;</span><span class="s9"> </span><span class="s10">navigate</span><span class="s9">(</span><span class="s1">'/jobs'</span><span class="s9">)</span><span class="s7">}</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"text-blue-600 underline"</span><span class="s13">&gt;</span><span class="s3">â† Cancel</span><span class="s13">&lt;/</span><span class="s7">button</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;</span><span class="s7">button</span><span class="s3"> </span><span class="s5">onClick</span><span class="s9">=</span><span class="s7">{</span><span class="s5">handleSave</span><span class="s7">}</span><span class="s3"> </span><span class="s5">className</span><span class="s9">=</span><span class="s1">"bg-green-600 text-white px-4 py-2 rounded"</span><span class="s3"> </span><span class="s5">disabled</span><span class="s9">=</span><span class="s7">{</span><span class="s5">saving</span><span class="s7">}</span><span class="s13">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">Â  Â  </span></span><span class="s7">{</span><span class="s5">saving</span><span class="s9"> ? </span><span class="s1">'Updating...'</span><span class="s9"> : </span><span class="s1">'Update Field Job'</span><span class="s7">}</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">Â  </span></span><span class="s13">&lt;/</span><span class="s1">button</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p8"><span class="s13">&lt;/</span><span class="s1">div</span><span class="s13">&gt;</span></p>
<p class="p6"><span class="s1">);</span></p>
<p class="p6"><span class="s1">}</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p2"><span class="s2">export</span><span class="s3"> </span><span class="s2">default</span><span class="s3"> </span><span class="s1">FieldJobSummaryPage</span><span class="s3">;</span></p>
<p class="p4"><span class="s6"></span><br></p>
<p class="p4"><span class="s6"></span><br></p>
</body>
</html>
